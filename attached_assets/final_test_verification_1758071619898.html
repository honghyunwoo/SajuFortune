<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‰ ìµœì¢… ë²„ê·¸ ìˆ˜ì • ê²€ì¦</title>
    <script src="saju-core-functions.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .success-box { background: #d4edda; border: 2px solid #28a745; padding: 20px; margin: 15px 0; border-radius: 8px; }
        .test-box { background: #f0f8ff; border: 2px solid #007bff; padding: 20px; margin: 15px 0; border-radius: 8px; }
        .error { color: red; font-weight: bold; }
        .success { color: green; font-weight: bold; }
        .highlight { background: yellow; padding: 3px; font-weight: bold; }
        table { border-collapse: collapse; width: 100%; margin: 15px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: center; }
        th { background-color: #f2f2f2; }
        .console-output { background: #1e1e1e; color: #00ff00; padding: 15px; font-family: 'Courier New', monospace; border-radius: 5px; overflow-x: auto; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>ğŸ‰ ìµœì¢… ë²„ê·¸ ìˆ˜ì • ê²€ì¦ í…ŒìŠ¤íŠ¸</h1>
    <p><strong>ëª©í‘œ</strong>: ì¼ê°„ë³„ìì‹œì²œê°„ ë§¤í•‘ í…Œì´ë¸” ìˆ˜ì • í›„ ì‹œì£¼ ê³„ì‚°ì´ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸</p>

    <div class="success-box">
        <h2>ğŸ”§ ì ìš©ëœ ìˆ˜ì •ì‚¬í•­</h2>
        <p><strong>ë¬¸ì œ</strong>: ë¬´(æˆŠ)ì¼ì˜ ìì‹œì²œê°„ì´ 0(ê°‘ìì‹œ)ìœ¼ë¡œ ì˜ëª» ë§¤í•‘ë¨</p>
        <p><strong>í•´ê²°</strong>: ë¬´(4)ì¼ì˜ ìì‹œì²œê°„ì„ 8(ì„ìì‹œ)ë¡œ ì˜¬ë°”ë¥´ê²Œ ìˆ˜ì •</p>
        <p><strong>ì˜ˆìƒ ê²°ê³¼</strong>: 1989-10-06 12:56 â†’ ì‹œì£¼ê°€ ê²½ì˜¤(åºšåˆ)ì—ì„œ ë¬´ì˜¤(æˆŠåˆ)ë¡œ ìˆ˜ì •</p>
    </div>

    <div id="test-results"></div>

    <script>
        // ì½˜ì†” ì¶œë ¥ ìº¡ì²˜
        let consoleOutput = '';
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            consoleOutput += args.join(' ') + '\n';
        };

        function runFinalTest() {
            console.clear();
            consoleOutput = '';

            console.log('ğŸ‰ === ìµœì¢… ë²„ê·¸ ìˆ˜ì • ê²€ì¦ í…ŒìŠ¤íŠ¸ ===\n');

            const testCases = [
                { year: 1989, month: 10, day: 6, hour: 12, expected: 'ë¬´ì˜¤', desc: 'ì›ë³¸ ë²„ê·¸ ì¼€ì´ìŠ¤' },
                { year: 1989, month: 10, day: 6, hour: 11, expected: 'ì •ì˜¤', desc: 'ë¬´ì¼ 11ì‹œ (ì •ì˜¤ì‹œ)' },
                { year: 1989, month: 10, day: 6, hour: 13, expected: 'ê¸°ë¯¸', desc: 'ë¬´ì¼ 13ì‹œ (ê¸°ë¯¸ì‹œ)' },
                { year: 2000, month: 1, day: 1, hour: 12, expected: 'ë¬´ì˜¤', desc: 'ê°‘ì§„ì¼ 12ì‹œ í…ŒìŠ¤íŠ¸' },
            ];

            const results = [];

            testCases.forEach((testCase, index) => {
                console.log(`\nğŸ§ª í…ŒìŠ¤íŠ¸ ${index + 1}: ${testCase.desc}`);
                console.log(`ğŸ“… ${testCase.year}-${testCase.month}-${testCase.day} ${testCase.hour}ì‹œ`);

                const testDate = new Date(testCase.year, testCase.month - 1, testCase.day);
                const sajuResult = calculateë§Œì„¸ë ¥(testDate, testCase.hour);

                const actualHourPillar = sajuResult.hour.gan + sajuResult.hour.ji;
                const isCorrect = actualHourPillar === testCase.expected;

                console.log(`ğŸ“Š ê²°ê³¼: ${sajuResult.day.gan}${sajuResult.day.ji} ì¼ì£¼, ${actualHourPillar} ì‹œì£¼`);
                console.log(`âœ… ì˜ˆìƒ: ${testCase.expected}, ì‹¤ì œ: ${actualHourPillar} â†’ ${isCorrect ? 'ì •í™•!' : 'ì˜¤ë¥˜!'}`);

                results.push({
                    ...testCase,
                    dayPillar: sajuResult.day.gan + sajuResult.day.ji,
                    actualHourPillar: actualHourPillar,
                    isCorrect: isCorrect,
                    fullSaju: sajuResult
                });
            });

            // ì „ì²´ ê²°ê³¼ ë¶„ì„
            const totalTests = results.length;
            const passedTests = results.filter(r => r.isCorrect).length;
            const successRate = Math.round((passedTests / totalTests) * 100);

            console.log(`\nğŸ“Š === ìµœì¢… ê²°ê³¼ ===`);
            console.log(`ì´ í…ŒìŠ¤íŠ¸: ${totalTests}ê°œ`);
            console.log(`ì„±ê³µ: ${passedTests}ê°œ`);
            console.log(`ì‹¤íŒ¨: ${totalTests - passedTests}ê°œ`);
            console.log(`ì„±ê³µë¥ : ${successRate}%`);

            if (successRate === 100) {
                console.log('ğŸ‰ ì™„ë²½! ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!');
            } else {
                console.log('âš ï¸ ì¼ë¶€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨. ì¶”ê°€ ê²€í†  í•„ìš”.');
            }

            // HTML ê²°ê³¼ í‘œì‹œ
            displayFinalResults(results, successRate);
        }

        function displayFinalResults(results, successRate) {
            const resultsDiv = document.getElementById('test-results');

            let html = '<div class="test-box">';
            html += '<h2>ğŸ¯ ìµœì¢… ê²€ì¦ ê²°ê³¼</h2>';
            html += `<div style="text-align: center; font-size: 18px; font-weight: bold; color: ${successRate === 100 ? 'green' : 'orange'};">`;
            html += `ì„±ê³µë¥ : ${successRate}% (${results.filter(r => r.isCorrect).length}/${results.length})`;
            html += '</div>';
            html += '</div>';

            html += '<div class="test-box">';
            html += '<h2>ğŸ“Š ìƒì„¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>';
            html += '<table>';
            html += '<tr><th>í…ŒìŠ¤íŠ¸</th><th>ë‚ ì§œ</th><th>ì‹œê°„</th><th>ì¼ì£¼</th><th>ì˜ˆìƒ ì‹œì£¼</th><th>ì‹¤ì œ ì‹œì£¼</th><th>ê²°ê³¼</th></tr>';

            results.forEach((result, index) => {
                const bgColor = result.isCorrect ? '#d4edda' : '#f8d7da';
                html += `<tr style="background-color: ${bgColor};">`;
                html += `<td>${index + 1}</td>`;
                html += `<td>${result.year}-${result.month.toString().padStart(2,'0')}-${result.day.toString().padStart(2,'0')}</td>`;
                html += `<td>${result.hour}ì‹œ</td>`;
                html += `<td>${result.dayPillar}</td>`;
                html += `<td>${result.expected}</td>`;
                html += `<td class="highlight">${result.actualHourPillar}</td>`;
                html += `<td>${result.isCorrect ? '<span class="success">âœ… ì„±ê³µ</span>' : '<span class="error">âŒ ì‹¤íŒ¨</span>'}</td>`;
                html += '</tr>';
            });

            html += '</table>';
            html += '</div>';

            // ì›ë³¸ ë²„ê·¸ ì¼€ì´ìŠ¤ íŠ¹ë³„ ë¶„ì„
            const originalCase = results[0];
            html += '<div class="' + (originalCase.isCorrect ? 'success-box' : 'test-box') + '">';
            html += '<h2>ğŸ¯ ì›ë³¸ ë²„ê·¸ ì¼€ì´ìŠ¤ ë¶„ì„</h2>';
            html += `<p><strong>í…ŒìŠ¤íŠ¸ ì¡°ê±´</strong>: 1989ë…„ 10ì›” 6ì¼ 12ì‹œ 56ë¶„</p>`;
            html += `<p><strong>ì´ì „ ê²°ê³¼</strong>: ê²½ì˜¤(åºšåˆ) âŒ</p>`;
            html += `<p><strong>ìˆ˜ì • í›„ ê²°ê³¼</strong>: <span class="highlight">${originalCase.actualHourPillar}</span> ${originalCase.isCorrect ? 'âœ…' : 'âŒ'}</p>`;

            if (originalCase.isCorrect) {
                html += '<p style="color: green; font-weight: bold;">ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ì›ë³¸ ë²„ê·¸ê°€ ì™„ì „íˆ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!</p>';
                html += '<p>ì´ì œ ì‹œì£¼ ê³„ì‚°ì´ ì „í†µ ì‚¬ì£¼í•™ ì´ë¡ ì— ë”°ë¼ ì •í™•í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.</p>';
            } else {
                html += '<p style="color: red; font-weight: bold;">âš ï¸ ì•„ì§ ì›ë³¸ ë²„ê·¸ê°€ ì™„ì „íˆ í•´ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>';
                html += '<p>ì¶”ê°€ ë¶„ì„ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>';
            }
            html += '</div>';

            // ì½˜ì†” ë¡œê·¸
            html += '<div class="test-box">';
            html += '<h2>ğŸ“‹ ë””ë²„ê¹… ë¡œê·¸</h2>';
            html += '<div class="console-output">' + consoleOutput + '</div>';
            html += '</div>';

            resultsDiv.innerHTML = html;
        }

        // ìë™ ì‹¤í–‰
        window.onload = function() {
            setTimeout(runFinalTest, 500);
        };
    </script>
</body>
</html>