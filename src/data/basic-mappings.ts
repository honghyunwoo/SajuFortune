/**
 * src/data/basic-mappings.ts
 *
 * 기본 매핑 테이블 (Basic Mappings)
 *
 * 10천간 × 8정격 = 80개 조합
 * 각 조합마다 용신, 희신, 기신, 근거, 출처 명시
 *
 * 출처:
 * - 자평진전 (子平眞詮): 격국론의 바이블
 * - 적천수 (滴天髓): 조후론의 고전
 * - 명리정종 (命理正宗): 종합 이론서
 */

import type { 기본매핑 } from '../../shared/types';

// ============================================
// 갑일간 (甲日干) - 양목(陽木)
// ============================================

const 갑일간_매핑: 기본매핑[] = [
  // 1. 갑일간 + 정관격
  {
    일간: '갑',
    격국: '정관격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['화', '목'],
    근거: [
      '갑목 일간의 정관은 경금(庚金)이며, 경금으로 갑목을 다듬어 재목(材木)을 만듦',
      '토생금(土生金)의 원리로 토가 희신이 되어 관성을 돕고, 수생목(水生木)으로 일간을 적절히 생조',
      '화는 극금(火克金)하여 관성을 손상시키고, 목은 비겁으로 재성을 탈하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정관격',
      confidence: 0.88
    },
    기본확신도: 0.88,
    전제조건: [
      '월령에 경금(庚金)이 투출되어 정관격 성립',
      '일간 갑목이 중화(中和) 상태로 너무 강하지도 약하지도 않음',
      '관성이 청순(清純)하여 관살혼잡이 아님'
    ],
    예외상황: [
      {
        condition: '일간이 태왕(太旺)하여 극도로 강함 (비겁 3개 이상)',
        희신_변경: ['금', '화', '토'],
        기신_변경: ['수', '목'],
        explanation: '일간이 너무 강하면 설기(泄氣)가 우선이므로 화(식상)로 설하고, 수(인성)로 더 강하게 하는 것은 금지'
      },
      {
        condition: '관살혼잡 (정관+편관 동시 존재)',
        희신_변경: ['화', '식신'],
        기신_변경: ['금', '수'],
        explanation: '관살혼잡 시 식상(食傷)으로 관살을 제어하는 것이 우선'
      },
      {
        condition: '계절이 여름(火月)으로 조열(燥熱)함',
        희신_변경: ['수', '금'],
        기신_변경: ['화', '토'],
        explanation: '조후용신론에 따라 조열한 여름에는 수로 윤택하게 하는 것이 최우선'
      }
    ],
    유파별차이: {
      자평파: { 용신: '금', 우선순위: '격국 청순성 중시' },
      적천수파: { 용신: '금+수(조후)', 우선순위: '계절 조화 중시' },
      차이점설명: '자평파는 격국의 순수성을 중시하나, 적천수파는 계절에 따른 조후를 먼저 고려'
    }
  },

  // 2. 갑일간 + 편관격
  {
    일간: '갑',
    격국: '편관격',
    용신: '금',
    희신: ['금', '토', '식신'],
    기신: ['수', '목', '관살과다'],
    근거: [
      '갑목 일간의 편관은 신금(辛金)이며, 적당히 제어하면 권위와 위엄을 갖춤',
      '편관은 일간을 공격하는 흉신이므로 식신(丙火)으로 제살(制殺)하는 것이 핵심',
      '관살이 과다하면 일간이 위험하므로 식신으로 설기하거나 인수(水)로 통관'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편관격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: [
      '월령에 신금(辛金)이 투출되어 편관격 성립',
      '일간이 중화 상태',
      '식신(丙火)이 있어 제살(制殺) 가능'
    ],
    예외상황: [
      {
        condition: '관살이 극도로 많아 일간이 태약(太弱)함',
        희신_변경: ['수', '목'],
        기신_변경: ['금', '토'],
        explanation: '일간이 너무 약하면 인성(水)으로 통관하고 비겁(木)으로 도와야 함'
      },
      {
        condition: '식신(丙火)이 없어 제살 불가',
        희신_변경: ['수', '목'],
        기신_변경: ['금'],
        explanation: '식신이 없으면 살인상생(殺印相生)으로 수(인성)를 용신으로 삼음'
      }
    ]
  },

  // 3. 갑일간 + 정재격
  {
    일간: '갑',
    격국: '정재격',
    용신: '토',
    희신: ['토', '금', '화'],
    기신: ['목', '수'],
    근거: [
      '갑목 일간의 정재는 기토(己土)이며, 갑목이 기토를 극하여 재물을 얻음',
      '일간이 왕(旺)해야 재를 감당할 수 있으므로 비겁(木)이 적당히 있어야 하나, 과다하면 탈재',
      '식상(火)은 생재(生財)하므로 희신, 인성(水)은 극재(克財)하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: [
      '월령에 기토(己土)가 투출되어 정재격 성립',
      '일간이 왕(旺)하여 재를 감당 가능',
      '재가 과다하지 않음'
    ],
    예외상황: [
      {
        condition: '일간이 태약(太弱)하여 재를 감당 못함',
        희신_변경: ['목', '수'],
        기신_변경: ['토', '금'],
        explanation: '재다신약(財多身弱)은 재가 재앙이 되므로 일간을 강하게 해야 함'
      },
      {
        condition: '비겁(木)이 과다하여 탈재(奪財)',
        희신_변경: ['금', '토'],
        기신_변경: ['목', '수'],
        explanation: '비겁이 많으면 재를 빼앗으므로 관살(金)로 비겁을 제어'
      }
    ]
  },

  // 4. 갑일간 + 편재격
  {
    일간: '갑',
    격국: '편재격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['목', '수'],
    근거: [
      '갑목 일간의 편재는 무토(戊土)이며, 재를 구하되 쟁취하는 성향',
      '편재는 정재보다 활동적이며, 일간이 강해야 재를 다룰 수 있음',
      '식상(火)으로 생재하고 관성(金)으로 호재(護財)함'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: [
      '월령에 무토(戊土)가 투출',
      '일간이 왕하여 재를 감당',
      '재가 적당한 양'
    ],
    예외상황: [
      {
        condition: '재다신약(財多身弱)',
        희신_변경: ['목', '수'],
        기신_변경: ['토', '화'],
        explanation: '일간을 강하게 하는 것이 우선'
      },
      {
        condition: '비겁 과다',
        희신_변경: ['금', '토'],
        기신_변경: ['목', '수'],
        explanation: '관살로 비겁 제어'
      }
    ]
  },

  // 5. 갑일간 + 식신격
  {
    일간: '갑',
    격국: '식신격',
    용신: '화',
    희신: ['화', '토', '목'],
    기신: ['금', '수'],
    근거: [
      '갑목 일간의 식신은 병화(丙火)이며, 목생화(木生火)로 설기(泄氣)하여 재를 생함',
      '식신격은 온화하고 길한 격국으로, 식신생재(食神生財)가 이루어지면 부귀',
      '편인(壬水)이 있으면 도식(倒食, 편인극식신)이 되어 흉함'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: [
      '월령에 병화(丙火)가 투출',
      '식신이 청순(清純)',
      '편인(壬水)이 없거나 약함'
    ],
    예외상황: [
      {
        condition: '편인(壬水) 투출로 도식(倒食)',
        희신_변경: ['재성(토)', '비겁(목)'],
        기신_변경: ['인성(수)'],
        explanation: '재성으로 편인을 극하거나, 비겁으로 편인을 설하여 도식 해결'
      },
      {
        condition: '식신이 너무 많아 설기 과다',
        희신_변경: ['수', '목'],
        기신_변경: ['화', '토'],
        explanation: '일간이 태약해지므로 인성과 비겁으로 일간 보강'
      }
    ]
  },

  // 6. 갑일간 + 상관격
  {
    일간: '갑',
    격국: '상관격',
    용신: '화',
    희신: ['화', '토'],
    기신: ['금', '수', '목과다'],
    근거: [
      '갑목 일간의 상관은 정화(丁火)이며, 상관은 관성을 극하는 흉성',
      '상관생재(傷官生財) 또는 상관배인(傷官佩印)이 되어야 길함',
      '상관견관(傷官見官)은 화근이 되므로 관성(金)을 꺼림'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: [
      '월령에 정화(丁火)가 투출',
      '재성(土) 또는 인성(水)이 있어 균형',
      '관성(金)이 없거나 약함'
    ],
    예외상황: [
      {
        condition: '상관견관(관성이 투출)',
        희신_변경: ['재성(토)'],
        기신_변경: ['관성(금)', '인성(수)'],
        explanation: '재성으로 통관하여 상관→재성→관성으로 기운 흐름 만듦'
      },
      {
        condition: '상관이 너무 많아 설기 과다',
        희신_변경: ['인성(수)', '비겁(목)'],
        기신_변경: ['화'],
        explanation: '인성으로 상관 제어하고 일간 보강'
      }
    ]
  },

  // 7. 갑일간 + 정인격
  {
    일간: '갑',
    격국: '정인격',
    용신: '수',
    희신: ['수', '목', '금'],
    기신: ['토', '화과다'],
    근거: [
      '갑목 일간의 정인은 계수(癸水)이며, 수생목(水生木)으로 일간을 생조',
      '정인격은 학문과 덕성을 상징하며, 관인상생(官印相生)이 되면 귀격',
      '재성(土)은 극인(克印)하므로 기신, 식상(火)은 설신(泄身)하나 적당하면 무방'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.89
    },
    기본확신도: 0.89,
    전제조건: [
      '월령에 계수(癸水)가 투출',
      '인성이 청순',
      '재성(土)이 없거나 약함'
    ],
    예외상황: [
      {
        condition: '인성이 과다하여 인다신약(印多身弱)',
        희신_변경: ['재성(토)', '식상(화)'],
        기신_변경: ['인성(수)'],
        explanation: '인성이 너무 많으면 재성으로 극하거나 식상으로 설기'
      },
      {
        condition: '재다파인(財多破印) - 재성이 과다',
        희신_변경: ['비겁(목)', '관성(금)'],
        기신_변경: ['재성(토)'],
        explanation: '비겁으로 재를 극하거나, 관성으로 재를 설하여 인성 보호'
      }
    ]
  },

  // 8. 갑일간 + 편인격
  {
    일간: '갑',
    격국: '편인격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['토', '화'],
    근거: [
      '갑목 일간의 편인은 임수(壬水)이며, 수생목으로 일간을 생하나 정인보다 강렬',
      '편인은 식신을 극하는 도식(倒食)의 우려가 있으므로 식신(丙火)과 동주하면 흉',
      '편인은 학술, 종교, 예술 방면에 재능을 부여'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: [
      '월령에 임수(壬水)가 투출',
      '식신(丙火)이 없거나 약함',
      '재성(土)이 강하지 않음'
    ],
    예외상황: [
      {
        condition: '식신(丙火)이 있어 도식 우려',
        희신_변경: ['재성(토)', '비겁(목)'],
        기신_변경: ['편인(수)'],
        explanation: '재성으로 편인을 극하거나 비겁으로 편인 설기'
      },
      {
        condition: '편인 과다',
        희신_변경: ['재성(토)', '식상(화)'],
        기신_변경: ['인성(수)'],
        explanation: '재성이나 식상으로 편인 제어'
      }
    ]
  }
];

// ============================================
// 병일간 (丙日干) - 양화(陽火) / 화 오행 기본
// ============================================

const 병일간_매핑: 기본매핑[] = [
  // 1. 병일간 + 정관격
  {
    일간: '병',
    격국: '정관격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['토', '화'],
    근거: [
      '병화 일간의 정관은 임수(壬水)이며, 수극화(水克火)로 화의 열기를 제어',
      '금생수(金生水)로 금이 희신이 되고, 목생화(木生火)로 일간을 적절히 생조',
      '토는 설화(泄火)하여 일간을 약하게 하고, 화는 비겁으로 재를 탈하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 화일간 정관격',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: [
      '월령에 임수(壬水)가 투출되어 정관격 성립',
      '일간 병화가 중화 상태',
      '관성이 청순'
    ],
    예외상황: [
      {
        condition: '일간이 태왕(비겁 과다)',
        희신_변경: ['수', '금', '토'],
        기신_변경: ['목', '화'],
        explanation: '화가 너무 강하면 설기(土)로 약화시키고, 생화(木) 금지'
      },
      {
        condition: '계절이 겨울(水月)로 한냉',
        희신_변경: ['목', '화'],
        기신_변경: ['수', '금'],
        explanation: '조후용신론에 따라 한랭한 겨울에는 목화로 따뜻하게'
      }
    ]
  },

  // 2. 병일간 + 편관격
  {
    일간: '병',
    격국: '편관격',
    용신: '수',
    희신: ['수', '토', '식신'],
    기신: ['목', '화'],
    근거: [
      '병화 일간의 편관은 계수(癸水)이며, 식신(戊土)으로 제살',
      '편관은 일간을 공격하나 적당히 제어하면 권위',
      '식신이 없으면 인성(木)으로 살인상생'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편관격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: [
      '월령에 계수(癸水) 투출',
      '식신(戊土) 존재',
      '관살 적당'
    ],
    예외상황: [
      {
        condition: '관살 과다로 일간 태약',
        희신_변경: ['목', '화'],
        기신_변경: ['수'],
        explanation: '인성(木)으로 통관하고 비겁(火)으로 도움'
      }
    ]
  },

  // 3. 병일간 + 정재격
  {
    일간: '병',
    격국: '정재격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['화', '목'],
    근거: [
      '병화 일간의 정재는 신금(辛金)이며, 화극금(火克金)으로 재물',
      '일간이 왕해야 재를 감당, 토는 생재(生財)하므로 희신',
      '비겁(火)은 탈재, 인성(木)은 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: [
      '월령에 신금(辛金) 투출',
      '일간 왕',
      '재 적당'
    ],
    예외상황: [
      {
        condition: '재다신약',
        희신_변경: ['화', '목'],
        기신_변경: ['금', '토'],
        explanation: '일간 강화 우선'
      }
    ]
  },

  // 4. 병일간 + 편재격
  {
    일간: '병',
    격국: '편재격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['화', '목'],
    근거: [
      '병화 일간의 편재는 경금(庚金)이며, 활동적 재물',
      '토(식상)으로 생재, 수(관성)로 호재',
      '비겁으로 탈재 방지'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장 격국론',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: ['월령에 경금', '일간 왕'],
    예외상황: [
      {
        condition: '재다신약',
        희신_변경: ['화', '목'],
        기신_변경: ['금'],
        explanation: '일간 강화'
      }
    ]
  },

  // 5. 병일간 + 식신격
  {
    일간: '병',
    격국: '식신격',
    용신: '토',
    희신: ['토', '금', '화'],
    기신: ['수', '목'],
    근거: [
      '병화 일간의 식신은 무토(戊土)이며, 화생토로 설기하여 재 생성',
      '식신생재 구조가 길함',
      '편인(甲木) 도식 주의'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 무토', '식신 청순', '편인 약함'],
    예외상황: [
      {
        condition: '편인(甲木) 도식',
        희신_변경: ['재성(금)', '비겁(화)'],
        기신_변경: ['인성(목)'],
        explanation: '재로 편인 극하거나 비겁으로 설기'
      }
    ]
  },

  // 6. 병일간 + 상관격
  {
    일간: '병',
    격국: '상관격',
    용신: '토',
    희신: ['토', '금'],
    기신: ['수', '목'],
    근거: [
      '병화 일간의 상관은 기토(己土)이며, 상관생재 또는 상관배인',
      '상관견관 흉',
      '재성으로 통관'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: ['월령에 기토', '재성 또는 인성 존재'],
    예외상황: [
      {
        condition: '상관견관',
        희신_변경: ['재성(금)'],
        기신_변경: ['관성(수)'],
        explanation: '재로 통관'
      }
    ]
  },

  // 7. 병일간 + 정인격
  {
    일간: '병',
    격국: '정인격',
    용신: '목',
    희신: ['목', '화', '수'],
    기신: ['금', '토'],
    근거: [
      '병화 일간의 정인은 을목(乙木)이며, 목생화로 생조',
      '관인상생 귀격',
      '재(금)로 극인 방지'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.88
    },
    기본확신도: 0.88,
    전제조건: ['월령에 을목', '인성 청순'],
    예외상황: [
      {
        condition: '인다신약',
        희신_변경: ['금', '토'],
        기신_변경: ['목'],
        explanation: '재로 인성 극하거나 식상으로 설기'
      }
    ]
  },

  // 8. 병일간 + 편인격
  {
    일간: '병',
    격국: '편인격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['금', '토'],
    근거: [
      '병화 일간의 편인은 갑목(甲木)이며, 목생화로 생하나 강렬',
      '도식(倒食) 우려',
      '학술 예술 재능'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: ['월령에 갑목', '식신(무토) 약함'],
    예외상황: [
      {
        condition: '식신 도식',
        희신_변경: ['금', '화'],
        기신_변경: ['목'],
        explanation: '재로 편인 극'
      }
    ]
  }
];

// ============================================
// 무일간 (戊日干) - 양토(陽土) / 토 오행 기본
// ============================================

const 무일간_매핑: 기본매핑[] = [
  // 1. 무일간 + 정관격
  {
    일간: '무',
    격국: '정관격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['금', '토'],
    근거: [
      '무토 일간의 정관은 갑목(甲木)이며, 목극토(木克土)로 토를 소통시켜 막힘 방지',
      '수생목(水生木)으로 수가 희신, 화생토(火生土)로 일간을 적절히 생조',
      '금은 설토(泄土)하고, 토는 비겁으로 재를 탈하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 토일간',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: ['월령에 갑목 투출', '일간 중화', '관성 청순'],
    예외상황: [
      {
        condition: '일간 태왕',
        희신_변경: ['목', '금', '수'],
        기신_변경: ['화', '토'],
        explanation: '토 과다 시 금으로 설기, 화로 생토 금지'
      }
    ]
  },

  // 2. 무일간 + 편관격
  {
    일간: '무',
    격국: '편관격',
    용신: '목',
    희신: ['목', '화', '식신'],
    기신: ['수', '토'],
    근거: [
      '무토 일간의 편관은 을목(乙木), 식신(庚金)으로 제살',
      '편관으로 토의 고정성 깨뜨림',
      '화(인성)로 살인상생 가능'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: ['을목 투출', '식신 존재'],
    예외상황: [
      {
        condition: '관살 과다',
        희신_변경: ['화', '토'],
        기신_변경: ['목'],
        explanation: '인성으로 통관'
      }
    ]
  },

  // 3. 무일간 + 정재격
  {
    일간: '무',
    격국: '정재격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['토', '화'],
    근거: [
      '무토 일간의 정재는 계수(癸水), 토극수로 재물 장악',
      '금(식상)으로 생재, 목(관성)으로 호재',
      '일간 왕해야 재 감당'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['계수 투출', '일간 왕'],
    예외상황: [
      {
        condition: '재다신약',
        희신_변경: ['토', '화'],
        기신_변경: ['수'],
        explanation: '일간 강화'
      }
    ]
  },

  // 4. 무일간 + 편재격
  {
    일간: '무',
    격국: '편재격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['토', '화'],
    근거: [
      '무토 일간의 편재는 임수(壬水), 활동적 재물',
      '식상 생재, 관성 호재',
      '비겁 탈재 방지'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: ['임수 투출', '일간 왕'],
    예외상황: []
  },

  // 5. 무일간 + 식신격
  {
    일간: '무',
    격국: '식신격',
    용신: '금',
    희신: ['금', '수', '토'],
    기신: ['화', '목'],
    근거: [
      '무토 일간의 식신은 경금(庚金), 토생금으로 설기',
      '식신생재 길격',
      '편인(丙火) 도식 주의'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: ['경금 투출', '식신 청순'],
    예외상황: [
      {
        condition: '편인 도식',
        희신_변경: ['수', '토'],
        기신_변경: ['화'],
        explanation: '재로 편인 극'
      }
    ]
  },

  // 6. 무일간 + 상관격
  {
    일간: '무',
    격국: '상관격',
    용신: '금',
    희신: ['금', '수'],
    기신: ['화', '목'],
    근거: [
      '무토 일간의 상관은 신금(辛金), 상관생재',
      '상관견관 흉',
      '재로 통관'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: ['신금 투출'],
    예외상황: []
  },

  // 7. 무일간 + 정인격
  {
    일간: '무',
    격국: '정인격',
    용신: '화',
    희신: ['화', '토', '목'],
    기신: ['수', '금'],
    근거: [
      '무토 일간의 정인은 정화(丁火), 화생토로 생조',
      '관인상생 귀격',
      '재(수)로 극인 방지'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['정화 투출', '인성 청순'],
    예외상황: []
  },

  // 8. 무일간 + 편인격
  {
    일간: '무',
    격국: '편인격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['수', '금'],
    근거: [
      '무토 일간의 편인은 병화(丙火), 화생토',
      '도식 우려',
      '학술 재능'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.80
    },
    기본확신도: 0.80,
    전제조건: ['병화 투출'],
    예외상황: []
  }
];

// ============================================
// 경일간 (庚日干) - 양금(陽金) / 금 오행 기본
// ============================================

const 경일간_매핑: 기본매핑[] = [
  // 1. 경일간 + 정관격
  {
    일간: '경',
    격국: '정관격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['수', '금'],
    근거: [
      '경금 일간의 정관은 병화(丙火), 화극금(火克金)으로 금을 단련',
      '목생화(木生火)로 목이 희신, 토생금(土生金)으로 일간 생조',
      '수는 설금하고, 금은 비겁 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: ['병화 투출', '일간 중화'],
    예외상황: []
  },

  // 2. 경일간 + 편관격
  {
    일간: '경',
    격국: '편관격',
    용신: '화',
    희신: ['화', '토', '식신'],
    기신: ['금', '수'],
    근거: [
      '경금 일간의 편관은 정화(丁火)이며, 화극금(火克金)으로 경금을 제어하여 권위와 위엄 부여',
      '식신(壬水)으로 제살(制殺)하는 것이 정격이나, 살이 적당하면 토(인성)로 살인상생(殺印相生) 구조 형성',
      '비겁(금)은 탈재하고, 수(식상)가 과다하면 설금(泄金)하여 일간 약화되므로 주의'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편관격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['월령에 정화 투출', '일간 중화 상태', '식신 존재하거나 인성으로 통관'],
    예외상황: [
      {
        condition: '관살이 과다하여 일간 태약',
        희신_변경: ['토', '금'],
        기신_변경: ['화', '수'],
        explanation: '인성(토)으로 통관하고 비겁(금)으로 일간 강화 우선'
      }
    ]
  },

  // 3. 경일간 + 정재격
  {
    일간: '경',
    격국: '정재격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['금', '토'],
    근거: [
      '경금 일간의 정재는 을목(乙木)이며, 금극목(金克木)으로 재물을 얻되, 강한 경금이 부드러운 을목을 다루는 형상',
      '일간이 왕(旺)해야 재를 감당할 수 있으며, 수(식상)는 생재(生財)하고 화(관성)는 호재(護財)하여 재물 보호',
      '비겁(금)은 재를 탈하므로 기신이며, 토(인성)는 극재(克財)하여 재물 손실 초래'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: ['월령에 을목 투출', '일간이 왕하여 재를 감당', '재가 과다하지 않음'],
    예외상황: [
      {
        condition: '재다신약(財多身弱) - 재가 과다하고 일간 약함',
        희신_변경: ['금', '토'],
        기신_변경: ['목', '수'],
        explanation: '일간 강화가 우선이므로 인성과 비겁 활용'
      }
    ]
  },

  // 4. 경일간 + 편재격
  {
    일간: '경',
    격국: '편재격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['금', '토'],
    근거: [
      '경금 일간의 편재는 갑목(甲木)이며, 강한 도끼(경금)가 큰 나무(갑목)를 베는 형상으로 활동적이고 적극적인 재물 획득',
      '수(식상)로 생재하고 화(관성)로 호재하여 재물 관리가 중요하며, 편재는 정재보다 유동성과 확장성이 큼',
      '비겁(금)이 많으면 탈재(奪財)하여 재물 분쟁 발생하고, 토(인성)는 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: ['월령에 갑목 투출', '일간 왕', '재가 과다하지 않음'],
    예외상황: [
      {
        condition: '비겁이 과다하여 탈재 우려',
        희신_변경: ['화', '목'],
        기신_변경: ['금', '토'],
        explanation: '관성(화)으로 비겁 제어하고 재성 보호'
      }
    ]
  },

  // 5. 경일간 + 식신격
  {
    일간: '경',
    격국: '식신격',
    용신: '수',
    희신: ['수', '목', '금'],
    기신: ['토', '화'],
    근거: [
      '경금 일간의 식신은 임수(壬水)이며, 금생수(金生水)로 경금이 설기(泄氣)하여 큰 물을 생성하는 형상',
      '식신생재(食神生財) 구조가 성립하면 길격이며, 목(재성)을 생하여 재물과 명예를 얻음',
      '편인(무토)이 있으면 도식(倒食, 토극수)의 흉함이 있으므로 재성(목)으로 편인을 제어해야 함'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 임수 투출', '식신 청순', '편인(무토) 약함'],
    예외상황: [
      {
        condition: '편인(무토) 투출로 도식',
        희신_변경: ['목', '금'],
        기신_변경: ['토', '화'],
        explanation: '재성(목)으로 편인 극하거나 비겁(금)으로 편인 설기'
      }
    ]
  },

  // 6. 경일간 + 상관격
  {
    일간: '경',
    격국: '상관격',
    용신: '수',
    희신: ['수', '목'],
    기신: ['토', '화'],
    근거: [
      '경금 일간의 상관은 계수(癸水)이며, 상관은 관성을 극하는 흉신이나 상관생재(傷官生財) 또는 상관배인(傷官佩印) 구조면 길',
      '상관생재로 목(재성)을 생하면 재물을 얻고, 상관견관(관성 병존)은 흉하므로 화(관성)를 꺼림',
      '토(편인)는 상관을 극하여 도식이 되고, 수가 과다하면 일간이 태약해지므로 조절 필요'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: ['월령에 계수 투출', '재성(목) 또는 인성(토) 존재', '관성(화) 약함'],
    예외상황: [
      {
        condition: '상관견관 - 관성(화) 투출',
        희신_변경: ['목', '수'],
        기신_변경: ['화', '토'],
        explanation: '재성(목)으로 통관하여 상관→재성→관성 흐름 만듦'
      }
    ]
  },

  // 7. 경일간 + 정인격
  {
    일간: '경',
    격국: '정인격',
    용신: '토',
    희신: ['토', '금', '화'],
    기신: ['목', '수'],
    근거: [
      '경금 일간의 정인은 기토(己土)이며, 토생금(土生金)으로 경금을 생조하여 학문과 덕성을 상징',
      '관인상생(官印相生) 구조가 되면 귀격이며, 화(관성)→토(인성)→금(일간)의 연쇄 생조로 부귀 겸전',
      '재성(목)은 극인(克印)하여 인성을 손상시키므로 기신이며, 식상(수)은 설신(泄身)하나 적당하면 무방'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.88
    },
    기본확신도: 0.88,
    전제조건: ['월령에 기토 투출', '인성 청순', '재성(목) 약함'],
    예외상황: [
      {
        condition: '인성이 과다하여 인다신약(印多身弱)',
        희신_변경: ['목', '수'],
        기신_변경: ['토', '화'],
        explanation: '재성(목)으로 인성 극하거나 식상(수)으로 설기'
      },
      {
        condition: '재다파인(財多破印) - 재성 과다',
        희신_변경: ['금', '화'],
        기신_변경: ['목'],
        explanation: '비겁(금)으로 재를 극하거나 관성(화)으로 재 설하여 인성 보호'
      }
    ]
  },

  // 8. 경일간 + 편인격
  {
    일간: '경',
    격국: '편인격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['목', '수'],
    근거: [
      '경금 일간의 편인은 무토(戊土)이며, 토생금으로 생하나 정인보다 강렬하고 편파적',
      '편인은 식신(임수)을 극하는 도식(倒食)의 우려가 있으므로 식신과 동주하면 흉하며, 학술·종교·예술 방면 재능',
      '재성(목)으로 편인을 제어하거나 비겁(금)으로 편인을 설기하여 균형 유지 필요'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: ['월령에 무토 투출', '식신(임수) 약함', '재성 적당'],
    예외상황: [
      {
        condition: '식신(임수) 투출로 도식',
        희신_변경: ['목', '금'],
        기신_변경: ['토'],
        explanation: '재성(목)으로 편인 극하거나 비겁(금)으로 편인 설기'
      }
    ]
  }
];

// ============================================
// 임일간 (壬日干) - 양수(陽水) / 수 오행 기본
// ============================================

const 임일간_매핑: 기본매핑[] = [
  // 1. 임일간 + 정관격
  {
    일간: '임',
    격국: '정관격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['목', '수'],
    근거: [
      '임수 일간의 정관은 무토(戊土), 토극수(土克水)로 수의 범람 방지',
      '화생토로 화가 희신, 금생수로 일간 생조',
      '목은 설수하고, 수는 비겁 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: [],
      page: '제3장',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: ['무토 투출', '일간 중화'],
    예외상황: []
  },

  // 2. 임일간 + 편관격
  {
    일간: '임',
    격국: '편관격',
    용신: '토',
    희신: ['토', '금', '식신'],
    기신: ['수', '목'],
    근거: [
      '임수 일간의 편관은 기토(己土)이며, 토극수(土克水)로 물의 범람을 제어하여 권위 부여',
      '식신(갑목)으로 제살(制殺)하거나, 금(인성)으로 살인상생(殺印相生) 구조 형성',
      '비겁(수)은 탈재하고, 목(식상)이 과다하면 설수하여 일간 약화되므로 조절 필요'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편관격',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: ['월령에 기토 투출', '식신 또는 인성 존재', '일간 중화'],
    예외상황: [
      {
        condition: '관살 과다로 일간 태약',
        희신_변경: ['금', '수'],
        기신_변경: ['토', '목'],
        explanation: '인성(금)으로 통관하고 비겁(수)으로 일간 강화'
      }
    ]
  },

  // 3. 임일간 + 정재격
  {
    일간: '임',
    격국: '정재격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['수', '금'],
    근거: [
      '임수 일간의 정재는 정화(丁火)이며, 수극화(水克火)로 큰 물이 작은 불을 제어하여 재물 획득',
      '목(식상)으로 생재하고 토(관성)로 호재하며, 일간이 왕해야 재를 감당 가능',
      '비겁(수)은 탈재하고, 금(인성)은 극재하여 재물 손실 초래하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['월령에 정화 투출', '일간 왕', '재 적당'],
    예외상황: [
      {
        condition: '재다신약 - 재가 과다하고 일간 약함',
        희신_변경: ['수', '금'],
        기신_변경: ['화', '목'],
        explanation: '일간 강화 우선'
      }
    ]
  },

  // 4. 임일간 + 편재격
  {
    일간: '임',
    격국: '편재격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['수', '금'],
    근거: [
      '임수 일간의 편재는 병화(丙火)이며, 큰 물이 태양을 제어하는 형상으로 활동적이고 적극적인 재물 획득',
      '목(식상)으로 생재하고 토(관성)로 호재하며, 편재는 정재보다 유동성과 확장성이 큰 특징',
      '비겁(수)이 많으면 탈재하고, 금(인성)은 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: ['월령에 병화 투출', '일간 왕', '재 과다하지 않음'],
    예외상황: [
      {
        condition: '비겁 과다로 탈재 우려',
        희신_변경: ['토', '화'],
        기신_변경: ['수', '금'],
        explanation: '관성(토)으로 비겁 제어'
      }
    ]
  },

  // 5. 임일간 + 식신격
  {
    일간: '임',
    격국: '식신격',
    용신: '목',
    희신: ['목', '화', '수'],
    기신: ['금', '토'],
    근거: [
      '임수 일간의 식신은 갑목(甲木)이며, 수생목(水生木)으로 큰 물이 큰 나무를 생하는 형상',
      '식신생재(食神生財)로 화(재성)를 생하면 재물과 명예를 얻으며, 온화하고 길한 격국',
      '편인(경금)이 있으면 도식(倒食, 금극목)의 흉함이 있으므로 재성(화)으로 편인 제어 필요'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: ['월령에 갑목 투출', '식신 청순', '편인(경금) 약함'],
    예외상황: [
      {
        condition: '편인(경금) 투출로 도식',
        희신_변경: ['화', '수'],
        기신_변경: ['금', '토'],
        explanation: '재성(화)으로 편인 극하거나 비겁(수)으로 편인 설기'
      }
    ]
  },

  // 6. 임일간 + 상관격
  {
    일간: '임',
    격국: '상관격',
    용신: '목',
    희신: ['목', '화'],
    기신: ['금', '토'],
    근거: [
      '임수 일간의 상관은 을목(乙木)이며, 상관은 관성을 극하는 흉신이나 상관생재 또는 상관배인 구조면 길',
      '상관생재로 화(재성)를 생하면 재물을 얻고, 상관견관(토관성 병존)은 흉하므로 주의',
      '금(편인)은 도식이 되고, 목이 과다하면 일간 태약해지므로 조절 필요'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: ['월령에 을목 투출', '재성(화) 존재', '관성(토) 약함'],
    예외상황: [
      {
        condition: '상관견관 - 관성(토) 투출',
        희신_변경: ['화', '목'],
        기신_변경: ['토', '금'],
        explanation: '재성(화)으로 통관하여 상관→재성→관성 흐름'
      }
    ]
  },

  // 7. 임일간 + 정인격
  {
    일간: '임',
    격국: '정인격',
    용신: '금',
    희신: ['금', '수', '토'],
    기신: ['화', '목'],
    근거: [
      '임수 일간의 정인은 신금(辛金)이며, 금생수(金生水)로 임수를 생조하여 학문과 덕성 상징',
      '관인상생(官印相生) 구조가 되면 귀격이며, 토(관성)→금(인성)→수(일간)의 연쇄 생조로 부귀',
      '재성(화)은 극인하여 인성 손상시키므로 기신이며, 식상(목)은 설신하나 적당하면 무방'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 신금 투출', '인성 청순', '재성(화) 약함'],
    예외상황: [
      {
        condition: '인성 과다하여 인다신약',
        희신_변경: ['화', '목'],
        기신_변경: ['금', '토'],
        explanation: '재성(화)으로 인성 극하거나 식상(목)으로 설기'
      }
    ]
  },

  // 8. 임일간 + 편인격
  {
    일간: '임',
    격국: '편인격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['화', '목'],
    근거: [
      '임수 일간의 편인은 경금(庚金)이며, 금생수로 생하나 정인보다 강렬하고 편파적',
      '편인은 식신(갑목)을 극하는 도식의 우려가 있으므로 식신과 동주하면 흉하며, 학술·종교·예술 재능',
      '재성(화)으로 편인 제어하거나 비겁(수)으로 편인 설기하여 균형 유지'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.80
    },
    기본확신도: 0.80,
    전제조건: ['월령에 경금 투출', '식신(갑목) 약함', '재성 적당'],
    예외상황: [
      {
        condition: '식신(갑목) 투출로 도식',
        희신_변경: ['화', '수'],
        기신_변경: ['금'],
        explanation: '재성(화)으로 편인 극하거나 비겁(수)으로 편인 설기'
      }
    ]
  }
];

// ============================================
// 을일간(乙) 매핑 - 음목(陰木) 기본
// 부드럽고 유연한 초목, 화초, 덩굴의 이미지
// ============================================

const 을일간_매핑: 기본매핑[] = [
  {
    일간: '을',
    격국: '정관격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['화', '목'],
    근거: [
      '을목 일간의 정관은 신금(辛金)이며, 보석이나 정교한 금속으로 화초를 다듬어 아름다운 꽃을 피우는 형상',
      '토생금(土生金)으로 관성을 생하고, 수생목(水生木)으로 일간을 적절히 길러주어 조화를 이룸',
      '화는 극금(火克金)하여 관성을 상하게 하고, 목(비겁)은 재성을 탈하므로 기신이나, 갑목보다는 경쟁이 덜함'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정관격',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: [
      '월령에 신금(辛金)이 투출되어 정관격 성립',
      '일간 을목이 적절한 강도로 너무 약하지 않음',
      '관성이 청순하여 관살혼잡 아님'
    ],
    예외상황: [
      {
        condition: '을목이 극약(極弱)하여 신금을 감당 못함',
        희신_변경: ['수', '목'],
        기신_변경: ['금', '화', '토'],
        explanation: '종격(從殺格)으로 전환 고려, 관을 따르거나 일간을 보강'
      },
      {
        condition: '병화(丙火) 투출로 관성 극함',
        희신_변경: ['수', '금'],
        기신_변경: ['화', '목'],
        explanation: '계수(癸水)로 병화를 제하여 관성 보호 (상관견관의 해소)'
      }
    ]
  },
  {
    일간: '을',
    격국: '편관격',
    용신: '화',
    희신: ['화', '수', '목'],
    기신: ['금', '토'],
    근거: [
      '을목 일간의 편관은 경금(庚金)이며, 도끼나 큰 금속이 연약한 화초를 압박하는 형상으로 제살(制殺)이 필수',
      '정화(丁火)로 경금을 제하여 합금(合金)하거나, 임수로 살인상생(殺印相生) 구조를 만들면 길격',
      '토는 생살(生殺)하여 압박을 강화하고, 비겁(목)은 있어도 경금을 막기 어려우므로 식상제살이나 인수화살이 우선'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제4장 격국론 - 칠살격',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: [
      '월령에 경금(庚金) 투출',
      '정화나 임수가 있어 제살 또는 화살 가능',
      '칠살이 태과하지 않음'
    ],
    예외상황: [
      {
        condition: '칠살이 극도로 강하고 제할 방법 없음',
        희신_변경: ['금', '토'],
        기신_변경: ['목', '수', '화'],
        explanation: '종살격(從殺格)으로 전환, 살을 따라가는 것이 길함'
      },
      {
        condition: '병화(丙火)가 있어 정화 대신 제살',
        희신_변경: ['수', '화'],
        기신_변경: ['금', '토'],
        explanation: '병화는 경금을 강하게 극하나 상관견관의 우려, 수로 조절'
      }
    ]
  },
  {
    일간: '을',
    격국: '정재격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['수', '목'],
    근거: [
      '을목 일간의 정재는 기토(己土)이며, 을목이 기토를 극하여 재물을 얻는 형상으로, 전원의 흙을 경작하는 이미지',
      '정화(식상)로 생재하여 목생화 화생토의 흐름을 만들고, 금(관성)으로 호재(護財)하여 비겁이 재물을 빼앗지 못하게 함',
      '수(인성)는 극재(克財)하여 재물 손실을 야기하고, 목(비겁)은 탈재(奪財)하여 경쟁자가 나타남'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: ['월령에 기토 투출', '재성 청순', '일간 중화'],
    예외상황: [
      {
        condition: '비겁(목) 태과로 탈재 심함',
        희신_변경: ['금', '화', '토'],
        기신_변경: ['수', '목'],
        explanation: '관성(금)으로 비겁 제어, 재다신약 방지'
      }
    ]
  },
  {
    일간: '을',
    격국: '편재격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['수', '목'],
    근거: [
      '을목 일간의 편재는 무토(戊土)이며, 을목이 큰 산의 흙을 극하여 활동적인 재물을 획득하는 형상',
      '정화(식상)로 생재하고 금(관성)으로 호재하여 재물 관리가 중요하며, 편재는 유동성과 확장성이 큼',
      '비겁(목)이 많으면 탈재하여 재물 분쟁 발생하고, 수(인성)는 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['월령에 무토 투출', '재성 태과 아님', '비겁 적당'],
    예외상황: [
      {
        condition: '재다신약(財多身弱)으로 일간이 극약',
        희신_변경: ['수', '목'],
        기신_변경: ['토', '화', '금'],
        explanation: '인수(수)와 비겁(목)으로 일간 보강 우선, 재물보다 건강 먼저'
      }
    ]
  },
  {
    일간: '을',
    격국: '식신격',
    용신: '화',
    희신: ['화', '토', '금'],
    기신: ['수', '목'],
    근거: [
      '을목 일간의 식신은 정화(丁火)이며, 목생화(木生火)로 촛불을 피우듯 은은하게 설기(泄氣)하는 형상',
      '식신생재(食神生財) 구조가 성립하면 길격이며, 토(재성)를 생하여 재물과 복록을 얻음',
      '편인(임수)이 있으면 도식(倒食, 수극화)의 흉함이 있으므로 재성(토)으로 편인을 제어하거나 비겁(목)으로 설기'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 정화 투출', '식신 청순', '편인 없거나 약함'],
    예외상황: [
      {
        condition: '임수(편인) 투출로 도식',
        희신_변경: ['토', '목'],
        기신_변경: ['수'],
        explanation: '재성(토)으로 편인 극하거나 비겁(목)으로 편인 설기'
      },
      {
        condition: '식신이 너무 많아 설기 과다',
        희신_변경: ['수', '목'],
        기신_변경: ['화', '토'],
        explanation: '인수(수)로 설기 방지, 일간 보강'
      }
    ]
  },
  {
    일간: '을',
    격국: '상관격',
    용신: '화',
    희신: ['화', '토', '수'],
    기신: ['금', '목'],
    근거: [
      '을목 일간의 상관은 병화(丙火)이며, 태양처럼 밝고 강하게 목을 태워 설기하는 형상',
      '상관생재(傷官生財)로 토(재성)를 생하거나, 상관배인(傷官佩印)으로 수(인성)와 조화를 이루면 길격',
      '신금(정관)이 있으면 상관견관(傷官見官)으로 화극금하여 흉하므로, 계수(인성)로 통관하거나 관성 없는 것이 좋음'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: ['월령에 병화 투출', '상관 강함', '관성 없거나 통관 가능'],
    예외상황: [
      {
        condition: '상관견관(신금 있음)',
        희신_변경: ['수', '토'],
        기신_변경: ['금', '화'],
        explanation: '계수로 통관(금생수 수생목) 또는 토로 설기하여 관성 보호'
      },
      {
        condition: '상관이 너무 강함',
        희신_변경: ['수', '금'],
        기신_변경: ['화', '목'],
        explanation: '인수(수)로 상관 설기 제어, 재성보다 조화 우선'
      }
    ]
  },
  {
    일간: '을',
    격국: '정인격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['토', '화'],
    근거: [
      '을목 일간의 정인은 계수(癸水)이며, 빗물이나 이슬이 화초를 촉촉하게 기르는 형상으로 생조(生助)의 은혜',
      '신금(정관)이 있으면 관인상생(官印相生) 길격이 되어 명예와 학문을 얻으며, 목(비겁)은 수를 설하여 인수 활용',
      '기토(정재)는 극인(克印)하여 인수를 손상시키고, 병화(상관)는 설인(泄印)하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.88
    },
    기본확신도: 0.88,
    전제조건: ['월령에 계수 투출', '인수 청순', '재성 약하거나 없음'],
    예외상황: [
      {
        condition: '신금(정관) 있어 관인상생',
        희신_변경: ['수', '금'],
        기신_변경: ['토', '화', '목'],
        explanation: '관인상생 구조 강화, 비겁은 중립'
      },
      {
        condition: '인수가 너무 많아 일간 태왕',
        희신_변경: ['화', '토'],
        기신_변경: ['수', '금'],
        explanation: '식상(화)으로 설기하거나 재성(토)으로 극인하여 균형'
      }
    ]
  },
  {
    일간: '을',
    격국: '편인격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['토', '화'],
    근거: [
      '을목 일간의 편인은 임수(壬水)이며, 강물이 화초를 기르는 형상으로 생조하나 때로 과습의 우려',
      '경금(편관)이 있으면 살인상생(殺印相生)으로 흉을 길로 바꾸며, 비겁(목)은 수를 설하여 과습 방지',
      '무토(편재)는 극인하여 인수를 손상시키고, 정화(식신)가 있으면 도식(倒食)의 우려가 있으나 을목은 갑목보다 영향 적음'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.80
    },
    기본확신도: 0.80,
    전제조건: ['월령에 임수 투출', '식신(정화) 약함', '재성 적당'],
    예외상황: [
      {
        condition: '정화(식신) 투출로 도식',
        희신_변경: ['토', '목'],
        기신_변경: ['수'],
        explanation: '재성(토)으로 편인 극하거나 비겁(목)으로 편인 설기'
      },
      {
        condition: '임수가 너무 많아 수다목부(水多木浮)',
        희신_변경: ['토', '화'],
        기신_변경: ['수', '금'],
        explanation: '토로 수를 제어하거나 화로 난방하여 균형'
      }
    ]
  }
];

// ============================================
// 정일간(丁) 매핑 - 음화(陰火) 기본
// 촛불, 등불, 은은하고 섬세한 불의 이미지
// ============================================

const 정일간_매핑: 기본매핑[] = [
  {
    일간: '정',
    격국: '정관격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['토', '화'],
    근거: [
      '정화 일간의 정관은 임수(壬水)이며, 촛불이 강물을 만나 음양조화를 이루는 형상으로, 임정합목(壬丁合木)의 특수성',
      '경금(금)으로 관성을 생하고, 갑목(인성)으로 화를 생하여 일간을 돕되, 합화의 조건을 체크',
      '토(식상)는 설관(泄官)하여 관성을 약화시키고, 병화(비겁)는 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정관격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: [
      '월령에 임수(壬水) 투출',
      '임정합목 조건 미충족 (합화 안 됨)',
      '관성이 청순하여 관살혼잡 아님'
    ],
    예외상황: [
      {
        condition: '임정합목(壬丁合木) 조건 충족',
        희신_변경: ['금', '수'],
        기신_변경: ['화', '토'],
        explanation: '합화하여 목이 되면 격국 변화, 목을 생하는 수와 금이 희신'
      },
      {
        condition: '정화가 극약하여 임수를 감당 못함',
        희신_변경: ['목', '화'],
        기신_변경: ['수', '금', '토'],
        explanation: '종격 고려, 일간 보강이 우선'
      }
    ]
  },
  {
    일간: '정',
    격국: '편관격',
    용신: '목',
    희신: ['목', '금', '화'],
    기신: ['수', '토'],
    근거: [
      '정화 일간의 편관은 계수(癸水)이며, 촛불이 이슬비를 만나 꺼질 위험이 있어 제살(制殺)이나 화살(化殺)이 필수',
      '갑목(인성)으로 살인상생하여 계수를 화하거나, 무토(식신)로 계수를 제하여 안정화',
      '경금은 생살하여 압박을 강화하고, 임수(정관)는 관살혼잡을 야기하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제4장 격국론 - 칠살격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: [
      '월령에 계수(癸水) 투출',
      '갑목이나 무토가 있어 제살/화살 가능',
      '칠살이 태과하지 않음'
    ],
    예외상황: [
      {
        condition: '칠살이 극도로 강하고 제할 방법 없음',
        희신_변경: ['수', '금'],
        기신_변경: ['화', '목', '토'],
        explanation: '종살격으로 전환, 살을 따라가는 것이 길함'
      },
      {
        condition: '갑목(인성) 태과하여 일간 태왕',
        희신_변경: ['금', '토'],
        기신_변경: ['목', '수'],
        explanation: '설기(토)나 극인(금)으로 균형'
      }
    ]
  },
  {
    일간: '정',
    격국: '정재격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['목', '화'],
    근거: [
      '정화 일간의 정재는 신금(辛金)이며, 촛불이 보석을 단련하고 빛나게 하는 형상으로, 정화제금(丁火制金)의 조화',
      '무토(식상)로 생재하여 화생토 토생금의 흐름을 만들고, 수(관성)로 호재하여 비겁이 재물을 빼앗지 못하게 함',
      '갑목(인성)은 극재하여 재물 손실을 야기하고, 병화(비겁)는 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: ['월령에 신금 투출', '재성 청순', '일간 중화'],
    예외상황: [
      {
        condition: '비겁(화) 태과로 탈재 심함',
        희신_변경: ['수', '토', '금'],
        기신_변경: ['목', '화'],
        explanation: '관성(수)으로 비겁 제어, 재다신약 방지'
      },
      {
        condition: '정화가 너무 약해 신금을 녹이지 못함',
        희신_변경: ['목', '화'],
        기신_변경: ['금', '수', '토'],
        explanation: '일간 보강이 우선, 재물은 나중'
      }
    ]
  },
  {
    일간: '정',
    격국: '편재격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['목', '화'],
    근거: [
      '정화 일간의 편재는 경금(庚金)이며, 촛불이 큰 금속을 만나 단련하는 형상으로 활동적인 재물',
      '무토(식상)로 생재하고 수(관성)로 호재하여 재물 관리가 중요하며, 편재는 유동성이 큼',
      '비겁(화)이 많으면 탈재하여 재물 분쟁 발생하고, 갑목(인성)은 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['월령에 경금 투출', '재성 태과 아님', '비겁 적당'],
    예외상황: [
      {
        condition: '재다신약(財多身弱)으로 일간이 극약',
        희신_변경: ['목', '화'],
        기신_변경: ['금', '토', '수'],
        explanation: '인수(목)와 비겁(화)으로 일간 보강 우선'
      }
    ]
  },
  {
    일간: '정',
    격국: '식신격',
    용신: '토',
    희신: ['토', '금', '수'],
    기신: ['목', '화'],
    근거: [
      '정화 일간의 식신은 기토(己土)이며, 촛불이 전원의 흙을 따뜻하게 하는 형상으로 설기(泄氣)',
      '식신생재(食神生財) 구조가 성립하면 길격이며, 금(재성)을 생하여 재물과 복록을 얻음',
      '편인(을목)이 있으면 도식(倒食)의 우려가 있으므로 재성(금)으로 편인을 제어'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 기토 투출', '식신 청순', '편인 없거나 약함'],
    예외상황: [
      {
        condition: '을목(편인) 투출로 도식',
        희신_변경: ['금', '화'],
        기신_변경: ['목'],
        explanation: '재성(금)으로 편인 극하거나 비겁(화)으로 편인 설기'
      },
      {
        condition: '식신이 너무 많아 설기 과다',
        희신_변경: ['목', '화'],
        기신_변경: ['토', '금'],
        explanation: '인수(목)로 설기 방지, 일간 보강'
      }
    ]
  },
  {
    일간: '정',
    격국: '상관격',
    용신: '토',
    희신: ['토', '금', '목'],
    기신: ['수', '화'],
    근거: [
      '정화 일간의 상관은 무토(戊土)이며, 촛불이 산의 흙을 따뜻하게 하는 형상으로 강하게 설기',
      '상관생재(傷官生財)로 금(재성)을 생하거나, 상관배인(傷官佩印)으로 목(인성)과 조화를 이루면 길격',
      '임수(정관)가 있으면 상관견관으로 토극수하여 흉하므로, 갑목(인성)으로 통관하거나 관성 없는 것이 좋음'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: ['월령에 무토 투출', '상관 강함', '관성 없거나 통관 가능'],
    예외상황: [
      {
        condition: '상관견관(임수 있음)',
        희신_변경: ['목', '금'],
        기신_변경: ['수', '토'],
        explanation: '갑목으로 통관(수생목 목생화) 또는 금으로 설기하여 관성 보호'
      },
      {
        condition: '상관이 너무 강함',
        희신_변경: ['목', '수'],
        기신_변경: ['토', '화'],
        explanation: '인수(목)로 상관 설기 제어'
      }
    ]
  },
  {
    일간: '정',
    격국: '정인격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['금', '토'],
    근거: [
      '정화 일간의 정인은 을목(乙木)이며, 화초가 촛불을 기르는 형상으로 목생화의 생조',
      '임수(정관)가 있으면 관인상생 길격이 되어 명예와 학문을 얻으며, 화(비겁)는 목을 설하여 인수 활용',
      '신금(정재)은 극인하여 인수를 손상시키고, 무토(상관)는 설인하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.88
    },
    기본확신도: 0.88,
    전제조건: ['월령에 을목 투출', '인수 청순', '재성 약하거나 없음'],
    예외상황: [
      {
        condition: '임수(정관) 있어 관인상생',
        희신_변경: ['목', '수'],
        기신_변경: ['금', '토', '화'],
        explanation: '관인상생 구조 강화, 비겁은 중립'
      },
      {
        condition: '인수가 너무 많아 일간 태왕',
        희신_변경: ['토', '금'],
        기신_변경: ['목', '수'],
        explanation: '식상(토)으로 설기하거나 재성(금)으로 극인하여 균형'
      }
    ]
  },
  {
    일간: '정',
    격국: '편인격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['금', '토'],
    근거: [
      '정화 일간의 편인은 갑목(甲木)이며, 큰 나무가 촛불을 기르는 형상으로 생조하나 때로 목다화염(木多火炎)의 우려',
      '계수(편관)가 있으면 살인상생으로 흉을 길로 바꾸며, 비겁(화)은 목을 설하여 과다 방지',
      '경금(편재)은 극인하여 인수를 손상시키고, 기토(식신)가 있으면 도식의 우려'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: ['월령에 갑목 투출', '식신(기토) 약함', '재성 적당'],
    예외상황: [
      {
        condition: '기토(식신) 투출로 도식',
        희신_변경: ['금', '화'],
        기신_변경: ['목'],
        explanation: '재성(금)으로 편인 극하거나 비겁(화)으로 편인 설기'
      },
      {
        condition: '갑목이 너무 많아 목다화염',
        희신_변경: ['금', '토'],
        기신_변경: ['목', '수'],
        explanation: '금으로 목을 제어하거나 토로 설기하여 균형'
      }
    ]
  }
];

// ============================================
// 기일간(己) 매핑 - 음토(陰土) 기본
// 전원의 흙, 농경지, 부드럽고 비옥한 흙의 이미지
// ============================================

const 기일간_매핑: 기본매핑[] = [
  {
    일간: '기',
    격국: '정관격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['금', '토'],
    근거: [
      '기토 일간의 정관은 을목(乙木)이며, 화초가 전원의 흙을 경작하는 형상으로, 을기합화토(乙己合化土)의 특수성',
      '계수(인성)로 목을 생하고, 정화(상관)로 토를 생하여 조화를 이루되, 합화의 조건을 체크',
      '경금(식상)은 설관하여 관성을 약화시키고, 무토(비겁)는 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정관격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: [
      '월령에 을목(乙木) 투출',
      '을기합화토 조건 미충족 (합화 안 됨)',
      '관성이 청순하여 관살혼잡 아님'
    ],
    예외상황: [
      {
        condition: '을기합화토(乙己合化土) 조건 충족',
        희신_변경: ['화', '토'],
        기신_변경: ['목', '수', '금'],
        explanation: '합화하여 토가 되면 격국 변화, 토를 생하는 화가 희신'
      },
      {
        condition: '기토가 극약하여 을목을 감당 못함',
        희신_변경: ['화', '토'],
        기신_변경: ['목', '수', '금'],
        explanation: '종격 고려, 일간 보강이 우선'
      }
    ]
  },
  {
    일간: '기',
    격국: '편관격',
    용신: '금',
    희신: ['금', '화', '토'],
    기신: ['목', '수'],
    근거: [
      '기토 일간의 편관은 갑목(甲木)이며, 큰 나무가 전원의 흙을 뚫고 자라는 형상으로 제살(制殺)이 필수',
      '경금(식신)으로 갑목을 제하여 안정화하거나, 정화(상관)로 생토하여 일간 강화',
      '계수(인성)는 생살하여 압박을 강화하고, 임수는 극화하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제4장 격국론 - 칠살격',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: [
      '월령에 갑목(甲木) 투출',
      '경금이나 정화가 있어 제살 가능',
      '칠살이 태과하지 않음'
    ],
    예외상황: [
      {
        condition: '칠살이 극도로 강하고 제할 방법 없음',
        희신_변경: ['목', '수'],
        기신_변경: ['토', '화', '금'],
        explanation: '종살격으로 전환, 살을 따라가는 것이 길함'
      },
      {
        condition: '정화(상관) 태과하여 일간 태왕',
        희신_변경: ['금', '수'],
        기신_변경: ['화', '토'],
        explanation: '설기(금)나 극화(수)로 균형'
      }
    ]
  },
  {
    일간: '기',
    격국: '정재격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['화', '토'],
    근거: [
      '기토 일간의 정재는 계수(癸水)이며, 전원의 흙이 빗물을 흡수하여 곡식을 기르는 형상',
      '경금(식상)으로 생재하여 토생금 금생수의 흐름을 만들고, 목(관성)으로 호재하여 비겁이 재물을 빼앗지 못하게 함',
      '정화(인성)는 극재하여 재물 손실을 야기하고, 무토(비겁)는 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: ['월령에 계수 투출', '재성 청순', '일간 중화'],
    예외상황: [
      {
        condition: '비겁(토) 태과로 탈재 심함',
        희신_변경: ['목', '금', '수'],
        기신_변경: ['화', '토'],
        explanation: '관성(목)으로 비겁 제어, 재다신약 방지'
      }
    ]
  },
  {
    일간: '기',
    격국: '편재격',
    용신: '수',
    희신: ['수', '금', '목'],
    기신: ['화', '토'],
    근거: [
      '기토 일간의 편재는 임수(壬水)이며, 전원의 흙이 강물을 막아 저수지를 만드는 형상으로 활동적인 재물',
      '경금(식상)으로 생재하고 목(관성)으로 호재하여 재물 관리가 중요하며, 편재는 유동성이 큼',
      '비겁(토)이 많으면 탈재하여 재물 분쟁 발생하고, 정화(인성)는 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['월령에 임수 투출', '재성 태과 아님', '비겁 적당'],
    예외상황: [
      {
        condition: '재다신약(財多身弱)으로 일간이 극약',
        희신_변경: ['화', '토'],
        기신_변경: ['수', '금', '목'],
        explanation: '인수(화)와 비겁(토)으로 일간 보강 우선'
      }
    ]
  },
  {
    일간: '기',
    격국: '식신격',
    용신: '금',
    희신: ['금', '수', '토'],
    기신: ['화', '목'],
    근거: [
      '기토 일간의 식신은 신금(辛金)이며, 전원의 흙에서 보석이 나오는 형상으로 설기(泄氣)',
      '식신생재(食神生財) 구조가 성립하면 길격이며, 수(재성)를 생하여 재물과 복록을 얻음',
      '편인(병화)이 있으면 도식(倒食)의 우려가 있으므로 재성(수)으로 편인을 제어'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: ['월령에 신금 투출', '식신 청순', '편인 없거나 약함'],
    예외상황: [
      {
        condition: '병화(편인) 투출로 도식',
        희신_변경: ['수', '토'],
        기신_변경: ['화'],
        explanation: '재성(수)으로 편인 극하거나 비겁(토)으로 편인 설기'
      },
      {
        condition: '식신이 너무 많아 설기 과다',
        희신_변경: ['화', '토'],
        기신_변경: ['금', '수'],
        explanation: '인수(화)로 설기 방지, 일간 보강'
      }
    ]
  },
  {
    일간: '기',
    격국: '상관격',
    용신: '금',
    희신: ['금', '수', '화'],
    기신: ['목', '토'],
    근거: [
      '기토 일간의 상관은 경금(庚金)이며, 전원의 흙에서 큰 금속이 나오는 형상으로 강하게 설기',
      '상관생재(傷官生財)로 수(재성)를 생하거나, 상관배인(傷官佩印)으로 화(인성)와 조화를 이루면 길격',
      '을목(정관)이 있으면 상관견관으로 금극목하여 흉하므로, 계수(수)로 통관하거나 관성 없는 것이 좋음'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: ['월령에 경금 투출', '상관 강함', '관성 없거나 통관 가능'],
    예외상황: [
      {
        condition: '상관견관(을목 있음)',
        희신_변경: ['수', '화'],
        기신_변경: ['목', '금'],
        explanation: '계수로 통관(목생화 화생토 토생금 금생수) 또는 화로 설목하여 관성 보호'
      },
      {
        condition: '상관이 너무 강함',
        희신_변경: ['화', '수'],
        기신_변경: ['금', '토'],
        explanation: '인수(화)로 상관 설기 제어'
      }
    ]
  },
  {
    일간: '기',
    격국: '정인격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['수', '금'],
    근거: [
      '기토 일간의 정인은 정화(丁火)이며, 촛불이 전원의 흙을 따뜻하게 하는 형상으로 화생토의 생조',
      '을목(정관)이 있으면 관인상생 길격이 되어 명예와 학문을 얻으며, 토(비겁)는 화를 설하여 인수 활용',
      '계수(정재)는 극인하여 인수를 손상시키고, 경금(상관)은 설인하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 정화 투출', '인수 청순', '재성 약하거나 없음'],
    예외상황: [
      {
        condition: '을목(정관) 있어 관인상생',
        희신_변경: ['화', '목'],
        기신_변경: ['수', '금', '토'],
        explanation: '관인상생 구조 강화, 비겁은 중립'
      },
      {
        condition: '인수가 너무 많아 일간 태왕',
        희신_변경: ['금', '수'],
        기신_변경: ['화', '목'],
        explanation: '식상(금)으로 설기하거나 재성(수)으로 극인하여 균형'
      }
    ]
  },
  {
    일간: '기',
    격국: '편인격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['수', '금'],
    근거: [
      '기토 일간의 편인은 병화(丙火)이며, 태양이 전원의 흙을 따뜻하게 하는 형상으로 생조하나 때로 화다토조(火多土燥)의 우려',
      '갑목(편관)이 있으면 살인상생으로 흉을 길로 바꾸며, 비겁(토)은 화를 설하여 과다 방지',
      '임수(편재)는 극인하여 인수를 손상시키고, 신금(식신)이 있으면 도식의 우려'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.80
    },
    기본확신도: 0.80,
    전제조건: ['월령에 병화 투출', '식신(신금) 약함', '재성 적당'],
    예외상황: [
      {
        condition: '신금(식신) 투출로 도식',
        희신_변경: ['수', '토'],
        기신_변경: ['화'],
        explanation: '재성(수)으로 편인 극하거나 비겁(토)으로 편인 설기'
      },
      {
        condition: '병화가 너무 많아 화다토조',
        희신_변경: ['수', '금'],
        기신_변경: ['화', '목'],
        explanation: '수로 화를 제어하거나 금으로 설기하여 균형'
      }
    ]
  }
];

// ============================================
// 신일간(辛) 매핑 - 음금(陰金) 기본
// 보석, 정교한 금속, 아름다운 장신구의 이미지
// ============================================

const 신일간_매핑: 기본매핑[] = [
  {
    일간: '신',
    격국: '정관격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['수', '금'],
    근거: [
      '신금 일간의 정관은 정화(丁火)이며, 촛불이 보석을 단련하여 빛나게 하는 형상으로, 정화제금(丁火制金)의 조화',
      '을목(인성)으로 화를 생하고, 기토(상관)로 금을 생하여 조화를 이루며, 정화는 신금을 빛나게 함',
      '계수(식상)는 설관하여 관성을 약화시키고, 경금(비겁)은 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정관격',
      confidence: 0.86
    },
    기본확신도: 0.86,
    전제조건: [
      '월령에 정화(丁火) 투출',
      '정화가 신금을 단련할 정도로 적절함',
      '관성이 청순하여 관살혼잡 아님'
    ],
    예외상황: [
      {
        condition: '신금이 극약하여 정화를 감당 못함',
        희신_변경: ['토', '금'],
        기신_변경: ['화', '수', '목'],
        explanation: '종격 고려, 일간 보강이 우선'
      },
      {
        condition: '계수(식신) 투출로 관성 극함',
        희신_변경: ['목', '토'],
        기신_변경: ['수', '금'],
        explanation: '을목으로 통관(수생목 목생화) 또는 기토로 설수하여 관성 보호'
      }
    ]
  },
  {
    일간: '신',
    격국: '편관격',
    용신: '수',
    희신: ['수', '토', '금'],
    기신: ['화', '목'],
    근거: [
      '신금 일간의 편관은 병화(丙火)이며, 태양이 보석을 녹이는 형상으로 제살(制殺)이나 화살(化殺)이 필수',
      '계수(식신)로 병화를 제하여 안정화하거나, 기토(인성)로 생금하여 일간 강화',
      '을목은 생살하여 압박을 강화하고, 갑목은 극금하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제4장 격국론 - 칠살격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: [
      '월령에 병화(丙火) 투출',
      '계수나 기토가 있어 제살/화살 가능',
      '칠살이 태과하지 않음'
    ],
    예외상황: [
      {
        condition: '칠살이 극도로 강하고 제할 방법 없음',
        희신_변경: ['화', '목'],
        기신_변경: ['금', '토', '수'],
        explanation: '종살격으로 전환, 살을 따라가는 것이 길함'
      },
      {
        condition: '기토(인성) 태과하여 일간 태왕',
        희신_변경: ['수', '목'],
        기신_변경: ['토', '금'],
        explanation: '설기(수)나 극토(목)로 균형'
      }
    ]
  },
  {
    일간: '신',
    격국: '정재격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['토', '금'],
    근거: [
      '신금 일간의 정재는 을목(乙木)이며, 보석 세공사가 화초를 다듬어 아름답게 하는 형상',
      '계수(식상)로 생재하여 금생수 수생목의 흐름을 만들고, 화(관성)로 호재하여 비겁이 재물을 빼앗지 못하게 함',
      '기토(인성)는 극재하여 재물 손실을 야기하고, 경금(비겁)은 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: ['월령에 을목 투출', '재성 청순', '일간 중화'],
    예외상황: [
      {
        condition: '비겁(금) 태과로 탈재 심함',
        희신_변경: ['화', '수', '목'],
        기신_변경: ['토', '금'],
        explanation: '관성(화)으로 비겁 제어, 재다신약 방지'
      }
    ]
  },
  {
    일간: '신',
    격국: '편재격',
    용신: '목',
    희신: ['목', '수', '화'],
    기신: ['토', '금'],
    근거: [
      '신금 일간의 편재는 갑목(甲木)이며, 보석 세공사가 큰 나무를 다듬는 형상으로 활동적인 재물',
      '계수(식상)로 생재하고 화(관성)로 호재하여 재물 관리가 중요하며, 편재는 유동성이 큼',
      '비겁(금)이 많으면 탈재하여 재물 분쟁 발생하고, 기토(인성)는 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['월령에 갑목 투출', '재성 태과 아님', '비겁 적당'],
    예외상황: [
      {
        condition: '재다신약(財多身弱)으로 일간이 극약',
        희신_변경: ['토', '금'],
        기신_변경: ['목', '수', '화'],
        explanation: '인수(토)와 비겁(금)으로 일간 보강 우선'
      }
    ]
  },
  {
    일간: '신',
    격국: '식신격',
    용신: '수',
    희신: ['수', '목', '금'],
    기신: ['토', '화'],
    근거: [
      '신금 일간의 식신은 계수(癸水)이며, 금생수(金生水)로 보석에서 이슬이 맺히는 형상으로 설기(泄氣)',
      '식신생재(食神生財) 구조가 성립하면 길격이며, 목(재성)을 생하여 재물과 복록을 얻음',
      '편인(무토)이 있으면 도식(倒食)의 우려가 있으므로 재성(목)으로 편인을 제어'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 계수 투출', '식신 청순', '편인 없거나 약함'],
    예외상황: [
      {
        condition: '무토(편인) 투출로 도식',
        희신_변경: ['목', '금'],
        기신_변경: ['토'],
        explanation: '재성(목)으로 편인 극하거나 비겁(금)으로 편인 설기'
      },
      {
        condition: '식신이 너무 많아 설기 과다',
        희신_변경: ['토', '금'],
        기신_변경: ['수', '목'],
        explanation: '인수(토)로 설기 방지, 일간 보강'
      }
    ]
  },
  {
    일간: '신',
    격국: '상관격',
    용신: '수',
    희신: ['수', '목', '토'],
    기신: ['화', '금'],
    근거: [
      '신금 일간의 상관은 임수(壬水)이며, 보석에서 큰 물이 흐르는 형상으로 강하게 설기',
      '상관생재(傷官生財)로 목(재성)을 생하거나, 상관배인(傷官佩印)으로 토(인성)와 조화를 이루면 길격',
      '정화(정관)가 있으면 상관견관으로 수극화하여 흉하므로, 을목(목)으로 통관하거나 관성 없는 것이 좋음'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.83
    },
    기본확신도: 0.83,
    전제조건: ['월령에 임수 투출', '상관 강함', '관성 없거나 통관 가능'],
    예외상황: [
      {
        condition: '상관견관(정화 있음)',
        희신_변경: ['목', '토'],
        기신_변경: ['화', '수'],
        explanation: '을목으로 통관(화생토 토생금 금생수 수생목) 또는 토로 설수하여 관성 보호'
      },
      {
        condition: '상관이 너무 강함',
        희신_변경: ['토', '목'],
        기신_변경: ['수', '금'],
        explanation: '인수(토)로 상관 설기 제어'
      }
    ]
  },
  {
    일간: '신',
    격국: '정인격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['목', '수'],
    근거: [
      '신금 일간의 정인은 기토(己土)이며, 전원의 흙에서 보석이 자라는 형상으로 토생금의 생조',
      '정화(정관)가 있으면 관인상생 길격이 되어 명예와 학문을 얻으며, 금(비겁)은 토를 설하여 인수 활용',
      '을목(정재)은 극인하여 인수를 손상시키고, 임수(상관)는 설인하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.88
    },
    기본확신도: 0.88,
    전제조건: ['월령에 기토 투출', '인수 청순', '재성 약하거나 없음'],
    예외상황: [
      {
        condition: '정화(정관) 있어 관인상생',
        희신_변경: ['토', '화'],
        기신_변경: ['목', '수', '금'],
        explanation: '관인상생 구조 강화, 비겁은 중립'
      },
      {
        condition: '인수가 너무 많아 일간 태왕',
        희신_변경: ['수', '목'],
        기신_변경: ['토', '화'],
        explanation: '식상(수)으로 설기하거나 재성(목)으로 극인하여 균형'
      }
    ]
  },
  {
    일간: '신',
    격국: '편인격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['목', '수'],
    근거: [
      '신금 일간의 편인은 무토(戊土)이며, 산의 흙에서 보석이 자라는 형상으로 생조하나 때로 토중금매(土重金埋)의 우려',
      '병화(편관)가 있으면 살인상생으로 흉을 길로 바꾸며, 비겁(금)은 토를 설하여 과다 방지',
      '갑목(편재)은 극인하여 인수를 손상시키고, 계수(식신)가 있으면 도식의 우려'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: ['월령에 무토 투출', '식신(계수) 약함', '재성 적당'],
    예외상황: [
      {
        condition: '계수(식신) 투출로 도식',
        희신_변경: ['목', '금'],
        기신_변경: ['토'],
        explanation: '재성(목)으로 편인 극하거나 비겁(금)으로 편인 설기'
      },
      {
        condition: '무토가 너무 많아 토중금매',
        희신_변경: ['목', '수'],
        기신_변경: ['토', '화'],
        explanation: '목으로 토를 제어하거나 수로 설기하여 균형'
      }
    ]
  }
];

// ============================================
// 계일간(癸) 매핑 - 음수(陰水) 기본
// 빗물, 이슬, 조용하고 섬세한 물의 이미지
// ============================================

const 계일간_매핑: 기본매핑[] = [
  {
    일간: '계',
    격국: '정관격',
    용신: '토',
    희신: ['토', '화', '금'],
    기신: ['목', '수'],
    근거: [
      '계수 일간의 정관은 무토(戊土)이며, 빗물이 산의 흙을 만나 흐름을 조절하는 형상으로 조화',
      '병화(인성)로 토를 생하고, 경금(상관)으로 수를 생하여 조화를 이루되, 수토의 균형이 중요',
      '갑목(식상)은 설관하여 관성을 약화시키고, 임수(비겁)는 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정관격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: [
      '월령에 무토(戊土) 투출',
      '계수가 적절한 강도로 너무 약하지 않음',
      '관성이 청순하여 관살혼잡 아님'
    ],
    예외상황: [
      {
        condition: '계수가 극약하여 무토를 감당 못함',
        희신_변경: ['금', '수'],
        기신_변경: ['토', '화', '목'],
        explanation: '종격 고려, 일간 보강이 우선'
      },
      {
        condition: '갑목(식신) 투출로 관성 극함',
        희신_변경: ['금', '화'],
        기신_변경: ['목', '수'],
        explanation: '경금으로 갑목 제하거나 병화로 통관하여 관성 보호'
      }
    ]
  },
  {
    일간: '계',
    격국: '편관격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['목', '화'],
    근거: [
      '계수 일간의 편관은 기토(己土)이며, 빗물이 전원의 흙을 만나 막히는 형상으로 제살(制殺) 필수',
      '경금(인성)으로 살인상생하여 기토를 화하거나, 을목(식신)으로 기토를 제하여 안정화',
      '병화는 생살하여 압박을 강화하고, 정화는 극수하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제4장 격국론 - 칠살격',
      confidence: 0.81
    },
    기본확신도: 0.81,
    전제조건: [
      '월령에 기토(己土) 투출',
      '경금이나 을목이 있어 제살/화살 가능',
      '칠살이 태과하지 않음'
    ],
    예외상황: [
      {
        condition: '칠살이 극도로 강하고 제할 방법 없음',
        희신_변경: ['토', '화'],
        기신_변경: ['수', '금', '목'],
        explanation: '종살격으로 전환, 살을 따라가는 것이 길함'
      },
      {
        condition: '경금(인성) 태과하여 일간 태왕',
        희신_변경: ['목', '화'],
        기신_변경: ['금', '토'],
        explanation: '설기(목)나 극금(화)으로 균형'
      }
    ]
  },
  {
    일간: '계',
    격국: '정재격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['금', '수'],
    근거: [
      '계수 일간의 정재는 정화(丁火)이며, 빗물이 촛불을 만나 음양조화를 이루는 형상으로 임정합목(壬丁合木)의 변형',
      '을목(식상)으로 생재하여 수생목 목생화의 흐름을 만들고, 토(관성)로 호재하여 비겁이 재물을 빼앗지 못하게 함',
      '경금(인성)은 극재하여 재물 손실을 야기하고, 임수(비겁)는 탈재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 정재격',
      confidence: 0.85
    },
    기본확신도: 0.85,
    전제조건: ['월령에 정화 투출', '재성 청순', '일간 중화'],
    예외상황: [
      {
        condition: '비겁(수) 태과로 탈재 심함',
        희신_변경: ['토', '목', '화'],
        기신_변경: ['금', '수'],
        explanation: '관성(토)으로 비겁 제어, 재다신약 방지'
      }
    ]
  },
  {
    일간: '계',
    격국: '편재격',
    용신: '화',
    희신: ['화', '목', '토'],
    기신: ['금', '수'],
    근거: [
      '계수 일간의 편재는 병화(丙火)이며, 빗물이 태양을 만나 증발하는 형상으로 활동적인 재물',
      '을목(식상)으로 생재하고 토(관성)로 호재하여 재물 관리가 중요하며, 편재는 유동성이 큼',
      '비겁(수)이 많으면 탈재하여 재물 분쟁 발생하고, 경금(인성)은 극재하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)'],
      page: '제3장 격국론 - 편재격',
      confidence: 0.84
    },
    기본확신도: 0.84,
    전제조건: ['월령에 병화 투출', '재성 태과 아님', '비겁 적당'],
    예외상황: [
      {
        condition: '재다신약(財多身弱)으로 일간이 극약',
        희신_변경: ['금', '수'],
        기신_변경: ['화', '목', '토'],
        explanation: '인수(금)와 비겁(수)으로 일간 보강 우선'
      }
    ]
  },
  {
    일간: '계',
    격국: '식신격',
    용신: '목',
    희신: ['목', '화', '수'],
    기신: ['금', '토'],
    근거: [
      '계수 일간의 식신은 을목(乙木)이며, 빗물이 화초를 기르는 형상으로 수생목의 설기(泄氣)',
      '식신생재(食神生財) 구조가 성립하면 길격이며, 화(재성)를 생하여 재물과 복록을 얻음',
      '편인(경금)이 있으면 도식(倒食)의 우려가 있으므로 재성(화)으로 편인을 제어'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 식신격',
      confidence: 0.87
    },
    기본확신도: 0.87,
    전제조건: ['월령에 을목 투출', '식신 청순', '편인 없거나 약함'],
    예외상황: [
      {
        condition: '경금(편인) 투출로 도식',
        희신_변경: ['화', '수'],
        기신_변경: ['금'],
        explanation: '재성(화)으로 편인 극하거나 비겁(수)으로 편인 설기'
      },
      {
        condition: '식신이 너무 많아 설기 과다',
        희신_변경: ['금', '수'],
        기신_변경: ['목', '화'],
        explanation: '인수(금)로 설기 방지, 일간 보강'
      }
    ]
  },
  {
    일간: '계',
    격국: '상관격',
    용신: '목',
    희신: ['목', '화', '금'],
    기신: ['토', '수'],
    근거: [
      '계수 일간의 상관은 갑목(甲木)이며, 빗물이 큰 나무를 기르는 형상으로 강하게 설기',
      '상관생재(傷官生財)로 화(재성)를 생하거나, 상관배인(傷官佩印)으로 금(인성)과 조화를 이루면 길격',
      '무토(정관)가 있으면 상관견관으로 목극토하여 흉하므로, 경금(금)으로 통관하거나 관성 없는 것이 좋음'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['적천수 (滴天髓)', '명리정종 (命理正宗)'],
      page: '제3장 격국론 - 상관격',
      confidence: 0.82
    },
    기본확신도: 0.82,
    전제조건: ['월령에 갑목 투출', '상관 강함', '관성 없거나 통관 가능'],
    예외상황: [
      {
        condition: '상관견관(무토 있음)',
        희신_변경: ['금', '화'],
        기신_변경: ['토', '목'],
        explanation: '경금으로 통관(토생금 금생수 수생목) 또는 화로 설목하여 관성 보호'
      },
      {
        condition: '상관이 너무 강함',
        희신_변경: ['금', '화'],
        기신_변경: ['목', '수'],
        explanation: '인수(금)로 상관 설기 제어'
      }
    ]
  },
  {
    일간: '계',
    격국: '정인격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['화', '목'],
    근거: [
      '계수 일간의 정인은 경금(庚金)이며, 큰 금속에서 빗물이 맺히는 형상으로 금생수의 생조',
      '무토(정관)가 있으면 관인상생 길격이 되어 명예와 학문을 얻으며, 수(비겁)는 금을 설하여 인수 활용',
      '정화(정재)는 극인하여 인수를 손상시키고, 갑목(상관)은 설인하므로 기신'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)', '적천수 (滴天髓)'],
      page: '제3장 격국론 - 정인격',
      confidence: 0.88
    },
    기본확신도: 0.88,
    전제조건: ['월령에 경금 투출', '인수 청순', '재성 약하거나 없음'],
    예외상황: [
      {
        condition: '무토(정관) 있어 관인상생',
        희신_변경: ['금', '토'],
        기신_변경: ['화', '목', '수'],
        explanation: '관인상생 구조 강화, 비겁은 중립'
      },
      {
        condition: '인수가 너무 많아 일간 태왕',
        희신_변경: ['목', '화'],
        기신_변경: ['금', '토'],
        explanation: '식상(목)으로 설기하거나 재성(화)으로 극인하여 균형'
      }
    ]
  },
  {
    일간: '계',
    격국: '편인격',
    용신: '금',
    희신: ['금', '토', '수'],
    기신: ['화', '목'],
    근거: [
      '계수 일간의 편인은 신금(辛金)이며, 보석에서 이슬이 맺히는 형상으로 생조하나 때로 금수청화(金水淸華)의 과냉',
      '기토(편관)가 있으면 살인상생으로 흉을 길로 바꾸며, 비겁(수)은 금을 설하여 과다 방지',
      '병화(편재)는 극인하여 인수를 손상시키고, 을목(식신)이 있으면 도식의 우려'
    ],
    출처: {
      primary: '자평진전 (子平眞詮)',
      secondary: ['명리정종 (命理正宗)'],
      page: '제3장 격국론 - 편인격',
      confidence: 0.80
    },
    기본확신도: 0.80,
    전제조건: ['월령에 신금 투출', '식신(을목) 약함', '재성 적당'],
    예외상황: [
      {
        condition: '을목(식신) 투출로 도식',
        희신_변경: ['화', '수'],
        기신_변경: ['금'],
        explanation: '재성(화)으로 편인 극하거나 비겁(수)으로 편인 설기'
      },
      {
        condition: '신금이 너무 많아 금수청화 과냉',
        희신_변경: ['화', '목'],
        기신_변경: ['금', '토'],
        explanation: '화로 난방하거나 목으로 설기하여 균형'
      }
    ]
  }
];

// ============================================
// 전체 매핑 배열 (80개)
// ============================================

export const BASIC_MAPPINGS: 기본매핑[] = [
  ...갑일간_매핑,
  ...을일간_매핑,
  ...병일간_매핑,
  ...정일간_매핑,
  ...무일간_매핑,
  ...기일간_매핑,
  ...경일간_매핑,
  ...신일간_매핑,
  ...임일간_매핑,
  ...계일간_매핑
];

// ============================================
// 유틸리티 함수
// ============================================

/**
 * 매핑 개수 확인
 */
export function getMappingCount(): number {
  return BASIC_MAPPINGS.length;
}

/**
 * 일간별 매핑 개수 확인
 */
export function getMappingCountByGan(): Record<string, number> {
  const counts: Record<string, number> = {};

  BASIC_MAPPINGS.forEach(m => {
    counts[m.일간] = (counts[m.일간] || 0) + 1;
  });

  return counts;
}

/**
 * 격국별 매핑 개수 확인
 */
export function getMappingCountByGeokguk(): Record<string, number> {
  const counts: Record<string, number> = {};

  BASIC_MAPPINGS.forEach(m => {
    counts[m.격국] = (counts[m.격국] || 0) + 1;
  });

  return counts;
}

/**
 * 매핑 테이블 유효성 검증
 */
export function validateMappings(): {
  valid: boolean;
  errors: string[];
  warnings: string[];
} {
  const errors: string[] = [];
  const warnings: string[] = [];

  // 1. 개수 확인
  const expectedCount = 80; // 10천간 × 8정격
  if (BASIC_MAPPINGS.length < expectedCount) {
    warnings.push(`매핑 개수 부족: ${BASIC_MAPPINGS.length}/${expectedCount}`);
  }

  // 2. 각 매핑 필드 검증
  BASIC_MAPPINGS.forEach((m, idx) => {
    const prefix = `[${idx + 1}] ${m.일간}-${m.격국}`;

    if (!m.일간) errors.push(`${prefix}: 일간 없음`);
    if (!m.격국) errors.push(`${prefix}: 격국 없음`);
    if (!m.용신) errors.push(`${prefix}: 용신 없음`);
    if (!m.희신 || m.희신.length === 0) errors.push(`${prefix}: 희신 없음`);
    if (!m.기신 || m.기신.length === 0) errors.push(`${prefix}: 기신 없음`);
    if (!m.근거 || m.근거.length < 3) errors.push(`${prefix}: 근거 부족 (${m.근거?.length || 0}/3)`);
    if (!m.출처?.primary) errors.push(`${prefix}: 주 출처 없음`);
    if (m.기본확신도 < 0.5 || m.기본확신도 > 0.95) {
      errors.push(`${prefix}: 확신도 범위 오류 (${m.기본확신도})`);
    }
    if (!m.전제조건 || m.전제조건.length === 0) {
      warnings.push(`${prefix}: 전제조건 없음`);
    }
  });

  return {
    valid: errors.length === 0,
    errors,
    warnings
  };
}
