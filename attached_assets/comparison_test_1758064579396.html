<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‘ ê°€ì§€ ì‹œì£¼ ê³„ì‚° ë°©ì‹ ë¹„êµ ë¶„ì„</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .debug-section { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .method-box { border: 2px solid #007bff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .method1 { border-color: #007bff; background: #f0f8ff; }
        .method2 { border-color: #dc3545; background: #fff5f5; }
        .step { margin: 5px 0; padding: 8px; background: white; border-left: 3px solid #007bff; }
        .error { color: red; font-weight: bold; }
        .success { color: green; font-weight: bold; }
        .warning { color: orange; font-weight: bold; }
        .highlight { background: yellow; padding: 2px; }
        .comparison { border: 2px solid #28a745; padding: 15px; margin: 10px 0; border-radius: 5px; }
        table { border-collapse: collapse; width: 100%; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; }
        .diff { background-color: #ffcccc; }
        .same { background-color: #ccffcc; }
    </style>
</head>
<body>
    <h1>ğŸ” ë‘ ê°€ì§€ ì‹œì£¼ ê³„ì‚° ë°©ì‹ ë¹„êµ ë¶„ì„</h1>
    <p><strong>í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:</strong> ì¼ê°„ ë¬´(æˆŠ), 12ì‹œ (ì˜¤ì‹œ)</p>

    <div id="debug-output"></div>

    <script>
        const ì²œê°„ = ['ê°‘', 'ì„', 'ë³‘', 'ì •', 'ë¬´', 'ê¸°', 'ê²½', 'ì‹ ', 'ì„', 'ê³„'];
        const ì§€ì§€ = ['ì', 'ì¶•', 'ì¸', 'ë¬˜', 'ì§„', 'ì‚¬', 'ì˜¤', 'ë¯¸', 'ì‹ ', 'ìœ ', 'ìˆ ', 'í•´'];

        // ë°©ë²• 1: ì›ë³¸ ì‚¬ì£¼í’€ì´ ì‹œìŠ¤í…œ ë°©ì‹ (ì¼ê°„ë³„ìì‹œì²œê°„ í…Œì´ë¸” ì‚¬ìš©)
        function getHourGapja_Method1(dayGan, hour) {
            const dayGanIndex = ì²œê°„.indexOf(dayGan);

            // ì‹œì§€ ê³„ì‚°
            let hourJiIndex;
            if (hour == 23 || (hour >= 0 && hour <= 0)) hourJiIndex = 0;
            else if (hour >= 1 && hour <= 2) hourJiIndex = 1;
            else if (hour >= 3 && hour <= 4) hourJiIndex = 2;
            else if (hour >= 5 && hour <= 6) hourJiIndex = 3;
            else if (hour >= 7 && hour <= 8) hourJiIndex = 4;
            else if (hour >= 9 && hour <= 10) hourJiIndex = 5;
            else if (hour >= 11 && hour <= 12) hourJiIndex = 6; // ì˜¤ì‹œ
            else if (hour >= 13 && hour <= 14) hourJiIndex = 7;
            else if (hour >= 15 && hour <= 16) hourJiIndex = 8;
            else if (hour >= 17 && hour <= 18) hourJiIndex = 9;
            else if (hour >= 19 && hour <= 20) hourJiIndex = 10;
            else if (hour >= 21 && hour <= 22) hourJiIndex = 11;
            else hourJiIndex = 6;

            // ì¼ê°„ë³„ìì‹œì²œê°„ ë§¤í•‘
            const ì¼ê°„ë³„ìì‹œì²œê°„ = {
                0: 0, 4: 0,  // ê°‘(0), ê¸°(4) â†’ ê°‘ìì‹œ(0)
                1: 2, 5: 2,  // ì„(1), ê²½(5) â†’ ë³‘ìì‹œ(2)
                2: 4, 6: 4,  // ë³‘(2), ì‹ (6) â†’ ë¬´ìì‹œ(4)
                3: 6, 7: 6,  // ì •(3), ì„(7) â†’ ê²½ìì‹œ(6)
                8: 8, 9: 8   // ë¬´(8), ê³„(9) â†’ ì„ìì‹œ(8)
            };

            const ìì‹œì²œê°„ = ì¼ê°„ë³„ìì‹œì²œê°„[dayGanIndex];
            const hourGanIndex = (ìì‹œì²œê°„ + hourJiIndex) % 10;

            return {
                gan: ì²œê°„[hourGanIndex],
                ji: ì§€ì§€[hourJiIndex],
                debug: {
                    method: "Method1 (ì¼ê°„ë³„ìì‹œì²œê°„)",
                    dayGanIndex,
                    hourJiIndex,
                    ìì‹œì²œê°„,
                    hourGanIndex,
                    calculation: `(${ìì‹œì²œê°„} + ${hourJiIndex}) % 10 = ${hourGanIndex}`
                }
            };
        }

        // ë°©ë²• 2: ìƒˆë¡œìš´ ë°©ì‹ (ìˆ˜í•™ì  ê³µì‹ ì‚¬ìš©)
        function calculateHourPillar_Method2(dayGan, hour) {
            // ì‹œê°„ëŒ€ë³„ ì§€ì§€ ê³„ì‚°
            let jiIndex;
            if (hour >= 23 || hour < 1) jiIndex = 0;      // ìì‹œ
            else if (hour >= 1 && hour < 3) jiIndex = 1;  // ì¶•ì‹œ
            else if (hour >= 3 && hour < 5) jiIndex = 2;  // ì¸ì‹œ
            else if (hour >= 5 && hour < 7) jiIndex = 3;  // ë¬˜ì‹œ
            else if (hour >= 7 && hour < 9) jiIndex = 4;  // ì§„ì‹œ
            else if (hour >= 9 && hour < 11) jiIndex = 5; // ì‚¬ì‹œ
            else if (hour >= 11 && hour < 13) jiIndex = 6; // ì˜¤ì‹œ
            else if (hour >= 13 && hour < 15) jiIndex = 7; // ë¯¸ì‹œ
            else if (hour >= 15 && hour < 17) jiIndex = 8; // ì‹ ì‹œ
            else if (hour >= 17 && hour < 19) jiIndex = 9; // ìœ ì‹œ
            else if (hour >= 19 && hour < 21) jiIndex = 10; // ìˆ ì‹œ
            else jiIndex = 11; // í•´ì‹œ

            // ì¼ê°„ì— ë”°ë¥¸ ì‹œê°„ ê³„ì‚°
            const dayGanIndex = ì²œê°„.indexOf(dayGan);
            const ganIndex = ((dayGanIndex * 2) + (jiIndex / 2)) % 10;

            return {
                gan: ì²œê°„[Math.floor(ganIndex)],
                ji: ì§€ì§€[jiIndex],
                debug: {
                    method: "Method2 (ìˆ˜í•™ì  ê³µì‹)",
                    dayGanIndex,
                    jiIndex,
                    ganIndex,
                    flooredGanIndex: Math.floor(ganIndex),
                    calculation: `((${dayGanIndex} * 2) + (${jiIndex} / 2)) % 10 = ${ganIndex}`
                }
            };
        }

        // ë¹„êµ ë¶„ì„ ì‹¤í–‰
        function compareHourCalculations() {
            const debugOutput = document.getElementById('debug-output');
            let html = '';

            const testCases = [
                { dayGan: 'ë¬´', hour: 12, expected: 'ë¬´ì˜¤' },
                { dayGan: 'ë¬´', hour: 11, expected: 'ì •ì˜¤' },
                { dayGan: 'ë¬´', hour: 13, expected: 'ê¸°ë¯¸' },
                { dayGan: 'ê°‘', hour: 12, expected: 'ê²½ì˜¤' },
                { dayGan: 'ì„', hour: 12, expected: 'ì„ì˜¤' }
            ];

            testCases.forEach((testCase, index) => {
                html += `<div class="debug-section">`;
                html += `<h2>ğŸ§ª í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ${index + 1}: ${testCase.dayGan}ì¼ ${testCase.hour}ì‹œ</h2>`;
                html += `<p><strong>ì˜ˆìƒ ê²°ê³¼:</strong> ${testCase.expected}</p>`;

                // ë°©ë²• 1 ì‹¤í–‰
                const result1 = getHourGapja_Method1(testCase.dayGan, testCase.hour);
                html += `<div class="method-box method1">`;
                html += `<h3>ğŸ“˜ ë°©ë²• 1: ì¼ê°„ë³„ìì‹œì²œê°„ í…Œì´ë¸” ë°©ì‹</h3>`;
                html += `<div class="step">`;
                html += `dayGanIndex = ${result1.debug.dayGanIndex}<br>`;
                html += `hourJiIndex = ${result1.debug.hourJiIndex}<br>`;
                html += `ìì‹œì²œê°„ = ${result1.debug.ìì‹œì²œê°„}<br>`;
                html += `ê³„ì‚°: ${result1.debug.calculation}<br>`;
                html += `<strong>ê²°ê³¼: ${result1.gan}${result1.ji}</strong>`;
                html += `</div></div>`;

                // ë°©ë²• 2 ì‹¤í–‰
                const result2 = calculateHourPillar_Method2(testCase.dayGan, testCase.hour);
                html += `<div class="method-box method2">`;
                html += `<h3>ğŸ“• ë°©ë²• 2: ìˆ˜í•™ì  ê³µì‹ ë°©ì‹</h3>`;
                html += `<div class="step">`;
                html += `dayGanIndex = ${result2.debug.dayGanIndex}<br>`;
                html += `jiIndex = ${result2.debug.jiIndex}<br>`;
                html += `ê³„ì‚°: ${result2.debug.calculation}<br>`;
                html += `flooredGanIndex = ${result2.debug.flooredGanIndex}<br>`;
                html += `<strong>ê²°ê³¼: ${result2.gan}${result2.ji}</strong>`;
                html += `</div></div>`;

                // ë¹„êµ ê²°ê³¼
                html += `<div class="comparison">`;
                html += `<h3>âš–ï¸ ë¹„êµ ê²°ê³¼</h3>`;
                const result1Full = result1.gan + result1.ji;
                const result2Full = result2.gan + result2.ji;

                if (result1Full === result2Full) {
                    html += `<span class="success">âœ… ë‘ ë°©ì‹ ê²°ê³¼ ì¼ì¹˜: ${result1Full}</span><br>`;
                } else {
                    html += `<span class="error">âŒ ë‘ ë°©ì‹ ê²°ê³¼ ë¶ˆì¼ì¹˜</span><br>`;
                    html += `ë°©ë²• 1: ${result1Full} vs ë°©ë²• 2: ${result2Full}<br>`;
                }

                if (result1Full === testCase.expected) {
                    html += `<span class="success">âœ… ë°©ë²• 1ì´ ì˜ˆìƒ ê²°ê³¼ì™€ ì¼ì¹˜</span><br>`;
                } else {
                    html += `<span class="error">âŒ ë°©ë²• 1ì´ ì˜ˆìƒ ê²°ê³¼ì™€ ë¶ˆì¼ì¹˜ (ì˜ˆìƒ: ${testCase.expected})</span><br>`;
                }

                if (result2Full === testCase.expected) {
                    html += `<span class="success">âœ… ë°©ë²• 2ê°€ ì˜ˆìƒ ê²°ê³¼ì™€ ì¼ì¹˜</span><br>`;
                } else {
                    html += `<span class="error">âŒ ë°©ë²• 2ê°€ ì˜ˆìƒ ê²°ê³¼ì™€ ë¶ˆì¼ì¹˜ (ì˜ˆìƒ: ${testCase.expected})</span><br>`;
                }
                html += `</div>`;
                html += `</div>`;
            });

            // ì „ì²´ ìš”ì•½ í…Œì´ë¸”
            html += `<div class="comparison">`;
            html += `<h2>ğŸ“Š ì „ì²´ ê²°ê³¼ ìš”ì•½</h2>`;
            html += `<table>`;
            html += `<tr><th>í…ŒìŠ¤íŠ¸</th><th>ì¼ê°„</th><th>ì‹œê°„</th><th>ì˜ˆìƒ</th><th>ë°©ë²•1</th><th>ë°©ë²•2</th><th>ë°©ë²•1 ì •í™•ë„</th><th>ë°©ë²•2 ì •í™•ë„</th></tr>`;

            testCases.forEach((testCase, index) => {
                const result1 = getHourGapja_Method1(testCase.dayGan, testCase.hour);
                const result2 = calculateHourPillar_Method2(testCase.dayGan, testCase.hour);
                const result1Full = result1.gan + result1.ji;
                const result2Full = result2.gan + result2.ji;

                html += `<tr>`;
                html += `<td>${index + 1}</td>`;
                html += `<td>${testCase.dayGan}</td>`;
                html += `<td>${testCase.hour}ì‹œ</td>`;
                html += `<td>${testCase.expected}</td>`;
                html += `<td class="${result1Full === testCase.expected ? 'same' : 'diff'}">${result1Full}</td>`;
                html += `<td class="${result2Full === testCase.expected ? 'same' : 'diff'}">${result2Full}</td>`;
                html += `<td>${result1Full === testCase.expected ? 'âœ…' : 'âŒ'}</td>`;
                html += `<td>${result2Full === testCase.expected ? 'âœ…' : 'âŒ'}</td>`;
                html += `</tr>`;
            });

            html += `</table>`;
            html += `</div>`;

            debugOutput.innerHTML = html;
        }

        // í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        window.onload = function() {
            console.log('ğŸ” ë‘ ê°€ì§€ ì‹œì£¼ ê³„ì‚° ë°©ì‹ ë¹„êµ ì‹œì‘...');
            compareHourCalculations();
        };
    </script>
</body>
</html>