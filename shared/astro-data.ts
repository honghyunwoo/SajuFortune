/**
 * 한국 전통 사주학 기본 데이터
 * 완성본에서 검증된 정확한 데이터를 TypeScript로 포팅
 */

// 천간 (하늘의 기운) - 10개
export const 천간 = ['갑', '을', '병', '정', '무', '기', '경', '신', '임', '계'] as const;
export const HEAVENLY_STEMS = 천간;

// 지지 (땅의 기운) - 12개  
export const 지지 = ['자', '축', '인', '묘', '진', '사', '오', '미', '신', '유', '술', '해'] as const;
export const EARTHLY_BRANCHES = 지지;

// 천간의 오행 매핑
export const 천간오행 = {
    '갑': '목', '을': '목', 
    '병': '화', '정': '화', 
    '무': '토', '기': '토', 
    '경': '금', '신': '금', 
    '임': '수', '계': '수'
} as const;

export const STEM_ELEMENTS = 천간오행;

// 지지의 오행 매핑
export const 지지오행 = {
    '자': '수', '축': '토', '인': '목', '묘': '목', 
    '진': '토', '사': '화', '오': '화', '미': '토', 
    '신': '금', '유': '금', '술': '토', '해': '수'
} as const;

export const BRANCH_ELEMENTS = 지지오행;

// 지장간 (지지 안에 숨어있는 천간들)
export const 지장간 = {
    '자': ['계'],
    '축': ['기', '계', '신'],
    '인': ['갑', '병', '무'],
    '묘': ['을'],
    '진': ['무', '을', '계'],
    '사': ['병', '무', '경'],
    '오': ['정', '기'],
    '미': ['기', '정', '을'],
    '신': ['경', '임', '무'],
    '유': ['신'],
    '술': ['무', '신', '정'],
    '해': ['임', '갑']
} as const;

export const HIDDEN_STEMS = 지장간;

// 십신표 (完成された正確なマッピング)
export const 십신표 = {
    '갑': {
        '갑': '비견', '을': '겁재', '병': '식신', '정': '상관', '무': '편재', 
        '기': '정재', '경': '편관', '신': '정관', '임': '편인', '계': '정인'
    },
    '을': {
        '갑': '겁재', '을': '비견', '병': '상관', '정': '식신', '무': '정재', 
        '기': '편재', '경': '정관', '신': '편관', '임': '정인', '계': '편인'
    },
    '병': {
        '갑': '편인', '을': '정인', '병': '비견', '정': '겁재', '무': '식신', 
        '기': '상관', '경': '편재', '신': '정재', '임': '편관', '계': '정관'
    },
    '정': {
        '갑': '정인', '을': '편인', '병': '겁재', '정': '비견', '무': '상관', 
        '기': '식신', '경': '정재', '신': '편재', '임': '정관', '계': '편관'
    },
    '무': {
        '갑': '편관', '을': '정관', '병': '편인', '정': '정인', '무': '비견', 
        '기': '겁재', '경': '식신', '신': '상관', '임': '편재', '계': '정재'
    },
    '기': {
        '갑': '정관', '을': '편관', '병': '정인', '정': '편인', '무': '겁재', 
        '기': '비견', '경': '상관', '신': '식신', '임': '정재', '계': '편재'
    },
    '경': {
        '갑': '편재', '을': '정재', '병': '편관', '정': '정관', '무': '편인', 
        '기': '정인', '경': '비견', '신': '겁재', '임': '식신', '계': '상관'
    },
    '신': {
        '갑': '정재', '을': '편재', '병': '정관', '정': '편관', '무': '정인', 
        '기': '편인', '경': '겁재', '신': '비견', '임': '상관', '계': '식신'
    },
    '임': {
        '갑': '식신', '을': '상관', '병': '편재', '정': '정재', '무': '편관', 
        '기': '정관', '경': '편인', '신': '정인', '임': '비견', '계': '겁재'
    },
    '계': {
        '갑': '상관', '을': '식신', '병': '정재', '정': '편재', '무': '정관', 
        '기': '편관', '경': '정인', '신': '편인', '임': '겁재', '계': '비견'
    }
} as const;

export const TEN_GODS_TABLE = 십신표;

// 십이지지의 동물 대응
export const 십이지동물 = {
    '자': '쥐', '축': '소', '인': '호랑이', '묘': '토끼',
    '진': '용', '사': '뱀', '오': '말', '미': '양',
    '신': '원숭이', '유': '닭', '술': '개', '해': '돼지'
} as const;

export const ZODIAC_ANIMALS = 십이지동물;

// 오행 관계 (상생, 상극)
export const 오행관계 = {
    상생: {
        목: '화', 화: '토', 토: '금', 금: '수', 수: '목'
    },
    상극: {
        목: '토', 화: '금', 토: '수', 금: '목', 수: '화'
    }
} as const;

export const ELEMENT_RELATIONS = 오행관계;

// TypeScript 타입 정의
export type 천간타입 = typeof 천간[number];
export type 지지타입 = typeof 지지[number];
export type 오행타입 = '목' | '화' | '토' | '금' | '수';
export type 십신타입 = '비견' | '겁재' | '식신' | '상관' | '편재' | '정재' | '편관' | '정관' | '편인' | '정인';

export type HeavenlyStem = 천간타입;
export type EarthlyBranch = 지지타입;
export type Element = 오행타입;
export type TenGod = 십신타입;

// 유틸리티 함수들
export function 십신계산(일간: 천간타입, 대상간: 천간타입): 십신타입 {
    return 십신표[일간][대상간];
}

export function get십신(dayGan: 천간타입, targetGan: 천간타입): 십신타입 {
    return 십신계산(dayGan, targetGan);
}

export function 오행변환(천간또는지지: 천간타입 | 지지타입): 오행타입 {
    if (천간.includes(천간또는지지 as 천간타입)) {
        return 천간오행[천간또는지지 as 천간타입];
    } else {
        return 지지오행[천간또는지지 as 지지타입];
    }
}

export function getElement(stem: 천간타입): 오행타입;
export function getElement(branch: 지지타입): 오행타입;
export function getElement(stemOrBranch: 천간타입 | 지지타입): 오행타입 {
    return 오행변환(stemOrBranch);
}

// 지장간의 가중치 (본기, 중기, 여기)
export const 지장간가중치 = { 0: 0.6, 1: 0.3, 2: 0.1 } as const;
export const HIDDEN_STEM_WEIGHTS = 지장간가중치;